webpackJsonp([7],{"+pnf":function(e,t){},"48dG":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("fZjL"),o=i.n(a),l=i("woOf"),s=i.n(l),c=i("ifoU"),h=i.n(c),n=i("//Fk"),r=i.n(n),d=i("bOdI"),u=i.n(d),p=i("2uFj");function g(e){return{submitBtn:!1,emptyBtn:!1,labelWidth:130,column:[{label:"出仓编号",prop:"retCode",span:6,placeholder:" ",disabled:!e.isPlan},{label:"出倉日期",prop:"retDate",span:6,placeholder:" ",disabled:!e.isPlan,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss"},{label:"出仓类型",prop:"retType",span:6,type:"select",disabled:!0,display:"6"!==e.hide,dicData:Object(p.a)("Whse_out_type")},{label:"配料编号",prop:"retBatch",span:6,placeholder:" ",display:"6"!==e.hide,disabled:!0},{label:"操作员",prop:"retUsername",display:!1,span:6,placeholder:" ",type:"select",dicData:Object(p.d)("ucmlUserList","employeename","employeename")},{label:"货运计划编号",prop:"spNo",span:6,placeholder:" ",display:"6"===e.hide,disabled:!0},{label:"财务状态",prop:"finStatus",span:6,placeholder:" ",type:"select",dicData:Object(p.a)("whse_finStatus"),display:"6"===e.hide,disabled:!0}]}}function f(e){return{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,height:"calc(100vh - 300px)",refreshBtn:!1,columnBtn:!1,page:!0,column:[{prop:"index",label:"序号",width:60,align:"center"},{label:"whseMaterialDlaoid",prop:"whseMaterialDlaoid",hide:!0},{label:"胚布编号",prop:"calicoId",cell:"6"!==e.hide,width:140,hide:"6"===e.hide},{label:"胚布名称",prop:"clothName",cell:"6"!==e.hide,width:400,hide:"6"===e.hide},{label:"订单号",prop:"woOrderno",cell:!1,width:140,hide:"6"!==e.hide},{label:"胚布编号",prop:"woMatno",cell:!1,width:140,hide:"6"!==e.hide},{label:"胚布名称",prop:"woMatname",cell:!1,width:400,hide:"6"!==e.hide},{label:"纱线出仓",prop:"WhseRetyarninFk",hide:!0,width:100}]}}function m(e){return{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,height:"calc(100vh - 287px)",refreshBtn:!1,columnBtn:!1,page:!0,showSummary:!0,sumColumnList:[{label:" ",name:"retWeight",type:"sum"},{label:" ",name:"traWeight",type:"sum"}],column:[{prop:"index",label:"序号",width:60,align:"center"},{label:"whseRetreatDtloid",prop:"whseRetreatDtloid",hide:!0},{label:"纱线系统编号",prop:"yarnsId",cell:!0,width:140,type:"select",dicData:Object(p.b)("whseYarninDtl/v1.0/list","yarnsId","whseYarninDtloid")},{label:"批次/批号",prop:"batchNo",cell:!0,width:180,type:"select",dicData:Object(p.b)("whseYarninDtl/v1.0/list","batchNo","whseYarninDtloid")},{label:"退回重量",prop:"retWeight",cell:!0,width:140,align:"right",hide:"4"!=e.hide&&"3"!=e.hide},{label:"单位",prop:"retCompany",cell:!0,width:100,type:"select",dicData:Object(p.a)("Whse_Transfer_unit"),hide:"4"!=e.hide&&"3"!=e.hide},{label:"调仓重量",prop:"traWeight",cell:!0,width:140,align:"right",hide:"5"!=e.hide},{label:"单位",prop:"traCompany",cell:!0,width:100,type:"select",dicData:Object(p.a)("Whse_Transfer_unit"),hide:"5"!=e.hide},{label:"退客人纱",prop:"whseRetreatFk",hide:!0,width:100}]}}function D(e){return{submitBtn:!1,emptyBtn:!1,labelWidth:130,column:[{label:"计划编号",prop:"retBatch",span:6,placeholder:" ",disabled:!0},{label:"设备编号",prop:"equCode",span:6,placeholder:" ",disabled:!0,display:"1"===e.hide},{label:"设备名称",prop:"equName",span:6,placeholder:" ",disabled:!0,display:"1"===e.hide},{label:"工厂代号",prop:"refCode",span:6,placeholder:" ",disabled:!0,display:"2"===e.hide},{label:"工厂名称",prop:"refName",span:6,placeholder:" ",disabled:!0,display:"2"===e.hide},{label:"生產單號",prop:"prOn",span:6,placeholder:" ",disabled:!0},{label:"胚布编号",prop:"calicoId",span:6,placeholder:" ",disabled:!0},{label:"批号",prop:"batchNo",span:6,placeholder:" "},{label:"布票号",prop:"custTicket",span:6,placeholder:" "}]}}var b=i("Tjk1"),y=i("4FKk"),w=i("g/wl"),v=i("mtWM"),x=i.n(v);function C(e){return x()({url:"/api/whseMaterial/page",method:"get",params:e})}function O(e){return x()({url:"/api/whseMaterial",method:"post",params:e})}function k(e){return x()({url:"/api/whseMaterial",method:"put",params:e})}function _(e){return x()({url:"/api/whseMaterial?whseMaterialoid="+e,method:"delete"})}function T(e){return x()({url:"/api/whseMaterialDla/page",method:"get",params:e})}function M(e){return x()({url:"/api/whseMaterialDla",method:"post",params:e})}function P(e){return x()({url:"/api/whseMaterialDla?whseMaterialDlaoid="+e,method:"delete"})}function N(e){return x()({url:"/api/whseMaterialDlb/page",method:"get",params:e})}function F(e){return x()({url:"/api/whseMaterialDlb",method:"post",params:e})}function V(e){return x()({url:"/api/whseMaterialDlb?whseMaterialDlboid="+e,method:"delete"})}function S(e){return x()({url:"/api/whseCalicosellout/page",method:"get",params:e})}function L(e){return x()({url:"/api/whseCalicosellout",method:"post",params:e})}function $(e){return x()({url:"/api/whseCalicosellout",method:"put",params:e})}function B(e){return x()({url:"/api/whseCalicosellout?whseCalicoselloutoid="+e,method:"delete"})}function j(e){return x()({url:"/api/whseCalicoselloutDtla/page",method:"get",params:e})}function H(e){return x()({url:"/api/whseCalicoselloutDtla",method:"post",params:e})}function I(e){return x()({url:"/api/whseCalicoselloutDtla?whseCalicoselloutDtlaoid="+e,method:"delete"})}function R(e){return x()({url:"/api/whseCalicoselloutDtlb/page",method:"get",params:e})}function E(e){return x()({url:"/api/whseCalicoselloutDtlb",method:"post",params:e})}function W(e){return x()({url:"/api/whseCalicoselloutDtlb?whseCalicoselloutDtlboid="+e,method:"delete"})}function q(e){return x()({url:"/api/whseMaterialPlan/page",method:"get",params:e})}function U(e){return x()({url:"/api/vWhseMaterialoutPlan/page",method:"get",params:e})}function z(e){return x()({url:"/api/whseRetreat/page",method:"get",params:e})}function Q(e){return x()({url:"/api/whseRetreat",method:"post",params:e})}function Y(e){return x()({url:"/api/whseRetreat",method:"put",params:e})}function J(e){return x()({url:"/api/whseRetreat?whseRetreatoid="+e,method:"delete"})}function K(e){return x()({url:"/api/whseRetreatDtl/page",method:"get",params:e})}function G(e){return x()({url:"/api/whseRetreatDtl",method:"post",params:e})}function X(e){return x()({url:"/api/whseRetreatDtl?whseRetreatDtloid="+e,method:"delete"})}function Z(e){return x()({url:"/api/whseTransfer/page",method:"get",params:e})}function A(e){return x()({url:"/api/whseTransfer",method:"post",params:e})}function ee(e){return x()({url:"/api/whseTransfer",method:"put",params:e})}function te(e){return x()({url:"/api/whseTransfer?whseTransferoid="+e,method:"delete"})}function ie(e){return x()({url:"/api/whseTransferDtl/page",method:"get",params:e})}function ae(e){return x()({url:"/api/whseTransferDtl",method:"post",params:e})}function oe(e){return x()({url:"/api/whseTransferDtl?whseTransferDtloid="+e,method:"delete"})}var le={props:{datas:Object,everyThing:Object,hide:String,detail:Object,isPlan:Boolean,PlanForm:Object},name:"",components:{choice:b.a},data:function(){return{loading:!1,page:{pageSize:10,currentPage:1,total:0},rcPage:{pageSize:10,currentPage:1,total:0},formOp:g(this),mxOp:f(this),mx:[],other:[],form:{},oldData:{},chooseData:{},changeList:[],canLeave:!1,ruleV:!1,sxV:!1,sxformOp:D(this),sxform:{},outform:{},outformOp:g(this),outcrudOp:f(this),outcrud:[],sxcrud:[],sxpage:{},rcOp:Object(y.e)(this),rcData:[],sxloading:!1,rcloading:!1,sxcheckList:[],planData:{},func:{},dlgTle:"選擇紗線配料",choosePh:{},isPh:!1,canSave:!0,outloading:!1,choiceV:!1,choiceTle:"选择订单胚布资料",choiceTarget:{},choiceField:"",choiceQ:{}}},watch:{},methods:{getDetail:function(){var e=this;if(this.loading=!0,0===o()(this.detail).length||!this.detail.whseCalicoselloutoid&&!this.detail.whseRetreatoid&&!this.detail.whseTransferoid)return this.mx=[],void(this.loading=!1);"3"===this.hide||"4"===this.hide?(this.func.getDetail=K,this.func.delDetail=X,this.func.addDetail=G,this.mxOp=m(this)):"5"===this.hide?(this.func.getDetail=ie,this.func.delDetail=oe,this.func.addDetail=ae,this.mxOp=m(this)):"6"===this.hide?(this.func.getDetail=j,this.func.delDetail=I,this.func.addDetail=H,this.func.getPhDetail=R,this.func.delPhDetail=W,this.func.addPhDetail=E):(this.func.getDetail=T,this.func.delDetail=P,this.func.addDetail=M,this.func.getPhDetail=N,this.func.delPhDetail=V,this.func.addPhDetail=F),this.func.getDetail({rows:this.page.pageSize,start:this.page.currentPage,whseMaterialFk:this.detail.whseMaterialoid,whseRetreatFk:this.detail.whseRetreatoid,whseTransferFk:this.detail.whseTransferoid}).then(function(t){var i=t.data;e.page.total=i.total,e.mx=i.records,e.oldData={},e.chooseData={},e.$refs.dlgcrud.setCurrentRow(),0===e.mx.length&&(e.loading=!1),e.mx.forEach(function(t,i){t.index=i+1,i===e.mx.length-1&&(e.loading=!1)})})},getPhDetail:function(e){var t=this;console.log(e),null!==e&&(e.whseMaterialDlaoid||e.whseCalicoselloutDtlaoid)?(this.rcloading=!0,this.rcOp.showSummary=!1,this.func.getPhDetail({rows:this.page.pageSize,start:this.page.currentPage,whseMaterialDlaFk:e.whseMaterialDlaoid,whseCalicoselloutDtlaFk:e.whseCalicoselloutDtlaoid}).then(function(e){var i=e.data;t.rcPage.total=i.total,t.rcData=i.records,0===t.rcData.length&&(t.rcloading=!1),t.rcData=t.rcData.sort(function(e,t){return t.countingNo-e.countingNo}),t.rcData.forEach(function(e,i){e.index=i+1,i===t.rcData.length-1&&(t.chooseData.list=t.rcData,t.rcOp.showSummary=!0,t.choosePh={},t.rcloading=!1)})})):this.rcData=[]},add:function(){"6"===this.hide?(this.choiceV=!this.choiceV,this.choiceField="woOrderno",this.oldData=this.chooseData,this.choiceTarget=this.oldData,this.choiceTle="选择订单胚布资料"):(this.outcrudOp=f(this),this.outcrudOp.column[2].hide=!1,this.outcrudOp.column[3].hide=!1,this.outcrudOp.column[3].width=700,this.sxformOp.column[0].display=!0,this.sxformOp.column[1].display="1"===this.hide,this.sxformOp.column[2].display="1"===this.hide,this.sxformOp.column[5].display=!0,this.sxformOp.column[7].display=!1,this.sxformOp.column[8].display=!1,this.outcrudOp.selection=!0,this.outcrudOp.showSummary=!1,this.outcrudOp.height="calc(100vh - 255px)",this.isPh=!1,this.sxV=!0)},addPh:function(){0!==o()(this.chooseData).length?"6"===this.hide?(this.choiceV=!this.choiceV,this.choiceField="woOrderno",this.oldData=this.chooseData,this.choiceTarget=this.oldData,this.choiceTle="选择胚布疋号资料"):(this.outcrudOp=Object(y.e)(this),this.sxformOp.column[0].display=!1,this.sxformOp.column[1].display=!1,this.sxformOp.column[2].display=!1,this.sxformOp.column[5].display=!1,this.sxformOp.column[7].display=!0,this.sxformOp.column[8].display=!0,this.outcrudOp.selection=!0,this.outcrudOp.showSummary=!1,this.outcrudOp.height="calc(100vh - 172px)",this.isPh=!0,this.sxV=!0):this.$tip.error("请先选择明细资料!")},del:function(){var e=this;if(null!=this.chooseData&&0!==o()(this.chooseData).length)return this.chooseData.whseMaterialDlaoid||this.chooseData.whseCalicoselloutDtlaoid?void this.$tip.cofirm("是否确定删除编号为【 "+("6"===this.hide?this.chooseData.woMatno:this.chooseData.calicoId)+" 】的数据?",this,{}).then(function(){e.func.delDetail("6"===e.hide?e.chooseData.whseCalicoselloutDtlaoid:e.chooseData.whseMaterialDlaoid).then(function(t){200===t.data.code?(e.$tip.success("删除成功"),e.mx.splice(e.chooseData.index-1,1),e.getDetail()):e.$tip.error("删除失败")}).catch(function(t){e.$tip.error("删除失败!")})}).catch(function(t){e.$tip.warning("取消操作")}):(this.mx.splice(this.chooseData.index-1,1),this.$refs.dlgcrud.setCurrentRow(this.mx[0]),void this.mx.forEach(function(e,t){e.index=t+1}));this.$tip.error("请选择要删除的数据!")},delPh:function(){var e=this;if(null!=this.choosePh&&0!==o()(this.choosePh).length)return this.choosePh.whseMaterialDlboid||this.choosePh.whseRetreatDtloid||this.choosePh.whseTransferDtloid?void this.$tip.cofirm("是否确定删除批号为 【"+this.choosePh.batchNo+" 】, 疋号为 【"+this.choosePh.countingNo+" 】的数据？",this,{}).then(function(){e.func.delPhDetail(e.choosePh.whseMaterialDlboid).then(function(t){200===t.data.code?(e.$tip.success("删除成功"),e.rcData.splice(e.choosePh.index-1,1),e.getPhDetail(e.chooseData)):e.$tip.error("删除失败")}).catch(function(t){e.$tip.error("删除失败!")})}).catch(function(t){e.$tip.warning("取消操作")}):this.isPlan?(this.chooseData.list.splice(this.choosePh.index-1,1),void this.$refs.dlgPhcrud.setCurrentRow()):(this.rcData.splice(this.choosePh.index-1,1),void this.$refs.dlgPhcrud.setCurrentRow());this.$tip.error("请选择要删除的数据!")},cellClick:function(e){null!==e&&(this.oldData=e,this.chooseData=e,this.chooseData.list||(this.chooseData.list=[]),this.getPhDetail(e))},cellPhClick:function(e){this.choosePh=e},close:function(){this.$emit("close")},getPbData:function(){var e=this;if(this.sxloading=!0,this.sxcrud=[],this.isPh)"6"===this.hide&&(this.chooseData.calicoId=this.chooseData.woMatno),this.dlgTle="胚布批号资料",Object(w.C)({calicoId:this.chooseData.calicoId}).then(function(t){for(var i in e.sxform.calicoId=e.chooseData.calicoId,e.sxform)""===e.sxform[i]&&delete e.sxform[i];if(0!==t.data.length){var a=t.data.map(function(t,i){return function(t,i){return new r.a(function(a,o){Object(w.D)(s()(e.sxform,{rows:e.sxpage.pageSize,start:e.sxpage.currentPage,whseCalicoinDtlaFk:t.whseCalicoinDtlaoid})).then(function(e){a(e.data.records,i)})})}(t,i)});r.a.all(a).then(function(t){t.forEach(function(i,a){e.sxcrud=e.sxcrud.concat(i),a===t.length-1&&(0===e.sxcrud.length&&(e.sxloading=!1),e.sxcrud.forEach(function(t,i){t.index=i+1,i===e.sxcrud.length-1&&(e.sxloading=!1)}))})})}else e.sxloading=!1});else{this.sxform.calicoId="";"1"===this.hide?this.func.getPlan=q:"2"===this.hide&&(this.func.getPlan=U),this.dlgTle="领料单明细",this.func.getPlan(s()(this.form,{rows:this.page.pageSize,start:this.page.currentPage,retBatch:this.detail.retBatch})).then(function(t){if(1===t.data.records.length){for(var i in e.planData=t.data.records[0],e.sxform=e.planData,e.sxform)""===e.sxform[i]&&delete e.sxform[i];(a=s()(e.sxform,{rows:e.sxpage.pageSize,start:e.sxpage.currentPage,calicoId:e.planData.calicoId}),x()({url:"/api/salEmbryogenesisDtl/page",method:"get",params:a})).then(function(t){var i=t.data;e.sxpage.total=i.total,e.sxcrud=i.records,e.sxcrud=e.unique(e.sxcrud,"calicoId"),0===e.sxcrud.length&&(e.sxloading=!1),e.sxcrud.forEach(function(t,i){t.index=i+1,i===e.sxcrud.length-1&&(e.sxloading=!1)})})}var a})}},sxselectionChange:function(e){this.sxcheckList=e,this.changeList=this.sxcheckList},check:function(){var e=this;if(this.isPh){for(var t=0;t<this.sxcheckList.length;t++)for(var i=0;i<this.chooseData.list.length;i++)if(this.sxcheckList[t].custTicket===this.chooseData.list[i].custTicket){this.sxcheckList[t].whseMaterialDlboid=this.chooseData.list[i].whseMaterialDlboid;break}this.chooseData.list=this.unique(this.chooseData.list.concat(this.sxcheckList),"custTicket"),this.chooseData.list.forEach(function(e,t){e.index=t+1})}else{for(var a=0;a<this.sxcheckList.length;a++)for(var o=0;o<this.mx.length;o++)if(this.sxcheckList[a].calicoId===this.mx[o].calicoId){this.sxcheckList[a].whseMaterialDlaoid=this.mx[o].whseMaterialDlaoid;break}"3"!=this.hide&&"4"!=this.hide&&"5"!=this.hide?(this.mx=this.unique(this.sxcheckList.concat(this.mx),"calicoId"),this.mx.forEach(function(e,t){e.index=t+1})):(this.sxcheckList.forEach(function(t,i){t.whseMaterialFk=e.detail.whseMaterialoid,t.index=e.mx.length+1}),this.mx=this.unique(this.mx.concat(this.sxcheckList),"whseCalicoinDtlaoid"))}this.sxcheckList=[],this.sxclose()},save:function(){var e=this;if(0!==this.mx.length){this.loading=!0;var t=this.mx.map(function(t,i){if(!t.whseMaterialDlaoid&&!t.whseCalicoselloutDtlaoid)return t.whseMaterialFk=e.detail.whseMaterialoid,t.whseCalicoselloutFk=e.detail.whseCalicoselloutoid,function(t,i){return new r.a(function(i,a){e.func.addDetail(t).then(function(e){t.whseCalicoselloutDtlaoid=e.data.data,i()})})}(t)});r.a.all(t).then(function(t){for(var i=function(t){console.log(t),e.mx[t].list&&e.mx[t].whseCalicoselloutDtlaoid&&e.mx[t].list.forEach(function(i){i.whseCalicoselloutDtlboid||(console.log(i),i.whseCalicoselloutDtlaFk=e.mx[t].whseCalicoselloutDtlaoid,e.func.addPhDetail(i).then(function(e){}))}),t===e.mx.length-1&&(e.changeList=[],e.getDetail(),e.$tip.success("保存成功!"))},a=0;a<e.mx.length;a++)i(a)})}},savePh:function(){console.log(this.mx)},savePlan:function(){var e=this;if(""!==this.form.retDate&&""!==this.form.retCode){this.outloading=!0;try{O(this.form).then(function(t){var i=e.mx.map(function(e,i){return function(e,i){return new r.a(function(a,o){M({whseMaterialFk:t.data.data,calicoId:e.calicoId,clothName:e.clothName}).then(function(e){a({oid:e.data.data,index:i})})})}(e,i)});r.a.all(i).then(function(t){t.length>0?t.forEach(function(i,a){void 0!=e.mx[i.index].list&&e.mx[i.index].list.length>0&&e.mx[i.index].list.forEach(function(e,t){F(s()(e,{whseMaterialDlaFk:i.oid})).then(function(e){})}),a===t.length-1&&(e.canSave=!1,e.outloading=!1,e.$emit("updateList"),e.$tip.success("保存成功!"))}):(e.canSave=!1,e.outloading=!1,e.$emit("updateList"),e.$tip.success("保存成功!"))})})}catch(e){this.outloading=!1}}else this.$tip.error("请输入出仓编号/日期")},choiceData:function(e){if(0!==o()(e).length){if(this.oldData.$cellEdit=!1,"选择订单胚布资料"===this.choiceTle){var t={woMatno:e.fabId,woMatname:e.fabName,woOrderno:e.$salPoFk,index:this.mx.length+1};this.mx.push(t)}else this.chooseData.list.push({index:this.chooseData.list+1});for(var i in this.oldData.$cellEdit=!0,e)delete e[i];for(var i in this.choiceQ)delete this.choiceQ[i];this.choiceV=!1}else this.choiceV=!1},sxclose:function(){this.outcrudOp.selection=!1,this.outcrudOp.showSummary=!0,this.outcrudOp.height="calc(100vh - 300px)",this.sxcheckList=[],this.sxV=!1},unique:function(e,t){var i=new h.a;return e.filter(function(e){return!i.has(e[t])&&i.set(e[t],1)})}},created:function(){},mounted:function(){this.rcOp.height="calc(100vh - 300px)","3"!==this.hide&&"4"!==this.hide&&"5"!==this.hide||(this.mxOp=m(this)),"6"===this.hide&&(this.detail.retCode=this.detail.woOutno,this.detail.retDate=this.detail.woDate),this.isPlan?this.form=this.PlanForm:this.form=this.detail},beforeDestroy:function(){}},se={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"rcDetail"}},[i("view-container",{directives:[{name:"loading",rawName:"v-loading",value:e.outloading,expression:"outloading"}],attrs:{title:e.datas.type.split("_")[0]+"资料","element-loading-text":"正在生成领料单...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[i("div",{staticClass:"btnList"},[e.canSave&&e.isPlan?i("el-button",{attrs:{type:"success"},on:{click:e.savePlan}},[e._v("保存")]):e._e(),e._v(" "),i("el-button",{attrs:{type:"warning"},on:{click:e.close}},[e._v("关闭")])],1),e._v(" "),i("div",{staticClass:"formBox"},[i("avue-form",{ref:"form",attrs:{option:e.formOp},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1),e._v(" "),i("el-row",[i("el-col",{attrs:{span:12}},[i("view-container",{attrs:{title:e.datas.type.split("_")[0]+"明细"}},[i("div",{staticClass:"btnList"},[e.canSave?i("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("新增")]):e._e(),e._v(" "),e.canSave?i("el-button",{attrs:{type:"danger"},on:{click:e.del}},[e._v("删除")]):e._e(),e._v(" "),e.isPlan?e._e():i("el-button",{attrs:{type:"success",disabled:0==e.changeList.length},on:{click:e.save}},[e._v("保存")])],1),e._v(" "),i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dlgcrud",staticStyle:{"margin-top":"-5px"},attrs:{option:e.mxOp,data:e.mx,page:e.page},on:{"update:page":function(t){e.page=t},"current-row-change":e.cellClick,"on-load":e.getDetail}})],1)],1),e._v(" "),i("el-col",{attrs:{span:12}},[i("view-container",{attrs:{title:e.datas.type.split("_")[0]+"批号资料"}},[i("div",{staticClass:"btnList"},[e.canSave?i("el-button",{attrs:{type:"primary"},on:{click:e.addPh}},[e._v("新增")]):e._e(),e._v(" "),e.canSave?i("el-button",{attrs:{type:"danger"},on:{click:e.delPh}},[e._v("删除")]):e._e(),e._v(" "),e.isPlan?e._e():i("el-button",{attrs:{type:"success"},on:{click:e.savePh}},[e._v("保存")])],1),e._v(" "),i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dlgPhcrud",staticStyle:{"margin-top":"-5px"},attrs:{option:e.rcOp,data:e.chooseData.list,page:e.page},on:{"update:page":function(t){e.page=t},"current-row-change":e.cellPhClick}})],1)],1)],1),e._v(" "),e.sxV?i("el-dialog",{attrs:{id:"sxPlanDlg",visible:e.sxV,"append-to-body":"",fullscreen:"","close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.sxclose},on:{"update:visible":function(t){e.sxV=t}}},[i("view-container",{attrs:{title:e.dlgTle}},[i("div",{staticClass:"btnList"},[i("el-button",{attrs:{type:"success"},on:{click:e.check}},[e._v("選擇")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.getPbData}},[e._v("查询")]),e._v(" "),i("el-button",{attrs:{type:"warning"},on:{click:e.sxclose}},[e._v("关闭")])],1),e._v(" "),i("div",{staticClass:"formBox"},[i("avue-form",{ref:"sxform",attrs:{option:e.sxformOp},model:{value:e.sxform,callback:function(t){e.sxform=t},expression:"sxform"}})],1),e._v(" "),i("div",{staticClass:"crudBox"},[i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"sxcrud",attrs:{id:"sxcrud",option:e.outcrudOp,data:e.sxcrud,page:e.sxpage},on:{"update:page":function(t){e.sxpage=t},"on-load":e.getPbData,"selection-change":e.sxselectionChange}})],1)])],1):e._e()],1),e._v(" "),e.choiceV?i("choice",{ref:"choice",attrs:{choiceV:e.choiceV,choiceTle:e.choiceTle,choiceQ:e.choiceQ,dlgWidth:"100%"},on:{choiceData:e.choiceData,close:function(t){e.choiceV=!1}}}):e._e()],1)},staticRenderFns:[]};var ce=i("VU/8")(le,se,!1,function(e){i("Tg7R")},null,null).exports,he=i("sLX/"),ne=i("gyMJ"),re={name:"",components:{ruleDlg:he.a,tem:ce},props:{tle:String,datas:Object,everyThing:Object,hide:String,detail:Object},data:function(){return{changeList:[],loading:!1,sxloading:!1,outloading:!1,page:{pageSize:10,currentPage:1,total:0},outpage:{pageSize:10,currentPage:1,total:0},sxpage:{pageSize:10,currentPage:1,total:0},form:{},formOp:{submitBtn:!1,emptyBtn:!1,labelWidth:130,column:[{label:"计划编号",prop:"retBatch",span:6,placeholder:" "},{label:"设备编号",prop:"equCode",span:6,placeholder:" "},{label:"批号",prop:"batchNo",span:6,placeholder:" "},{label:"胚布编号",prop:"calicoId",span:6,placeholder:" "}]},crudOp:(e=this,{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,height:"calc(100vh - 200px)",refreshBtn:!1,columnBtn:!1,page:!0,column:[{prop:"index",label:"序号",width:60,align:"center"},{label:"whseMaterialPlanoid",prop:"whseMaterialPlanoid",hide:!0},{label:"计划编号",prop:"retBatch",width:120,cell:!0,click:function(t){e.iptChange(e.chooseData)}},{label:"設備编号",prop:"equCode",cell:!0,width:120,hide:"1"!=e.hide},{label:"设备名称",prop:"equName",cell:!0,width:120,hide:"1"!=e.hide},{label:"加工厂代号",prop:"refCode",cell:!0,width:120,hide:"2"!=e.hide},{label:"加工厂名称",prop:"refName",cell:!0,width:120,hide:"2"!=e.hide},{label:"生產單號",prop:"prOn",cell:!0,width:180,click:function(t){e.iptChange(e.chooseData)}},{label:"胚布编号",prop:"calicoId",cell:!0,width:120,click:function(t){e.iptChange(e.chooseData)}},{label:"胚布名称",prop:"clothName",cell:!0,width:450,click:function(t){e.iptChange(e.chooseData)}},{label:"重量",prop:"weight",cell:!0,width:120,align:"right",click:function(t){e.iptChange(e.chooseData)}},{label:"单位",prop:"weightUnit",cell:!0,width:120,type:"select",dicData:Object(p.a)("Whse_Transfer_unit")}]}),crud:[],outform:{},outformOp:g(this),outcrudOp:f(this),outcrud:[],sxform:{},sxformOp:D(this),sxcrud:[{index:0}],chooseData:{},planV:!1,ruleV:!1,sxV:!1,sxcheck:{},sxcheckList:[],canSave:!0,func:{}};var e},watch:{},methods:{getData:function(){var e=this;for(var t in"1"===this.hide?this.func.getPlan=q:this.func.getPlan=U,this.form)""===this.form[t]&&delete this.form[t];this.func.getPlan(s()(this.form,{rows:this.page.pageSize,start:this.page.currentPage})).then(function(t){var i=t.data;e.page.total=i.total,e.crud=i.records,0===e.crud.length&&(e.loading=!1),o()(e.chooseData).length>0&&e.$refs.crud.setCurrentRow(e.crud[e.chooseData.index-1]),e.crud.forEach(function(t,i){t.index=i+1,i===e.crud.length-1&&(e.loading=!1)})})},getDetali:function(){},getSxData:function(){var e=this;for(var t in this.sxloading=!0,this.sxform)""===this.sxform[t]&&delete this.sxform[t];Object(w.K)(s()(this.sxform,{rows:this.sxpage.pageSize,start:this.sxpage.currentPage,yarnsId:this.outform.yarnsId})).then(function(t){var i=t.data;e.sxpage.total=i.total,e.sxcrud=i.records,0===e.sxcrud.length&&(e.sxloading=!1),e.sxcrud.forEach(function(t,i){t.index=i+1,t.yarnsName=t.yarnsId,i===e.sxcrud.length-1&&(e.sxloading=!1)})})},outOrder:function(){var e=this;o()(this.chooseData).length>0?(this.outform=this.chooseData,this.outform.retType=this.hide,this.outform.batchNumber=this.chooseData.retBatch,this.outform.retDate=this.getNowTime(),Object(ne.a)({code:"whse_Out_calico"}).then(function(t){e.outform.retCode=t.data.data}),this.outcrudOp.height="calc(100vh - 300px)",this.getDetali(),this.planV=!0):this.$tip.error("請先選擇配料計劃資料!")},addDetail:function(){this.outcrudOp.column[2].hide=!0,this.outcrudOp.column[3].hide=!0,this.outcrudOp.column[4].hide=!0,this.outcrudOp.column[5].hide=!0,this.outcrudOp.selection=!0,this.outcrudOp.showSummary=!1,this.outcrudOp.height="calc(100vh - 210px)",this.sxV=!0},sxselectionChange:function(e){this.sxcheckList=this.sxcheckList.concat(e)},check:function(){var e=this,t=this.unique(this.sxcheckList,"whseYarninDtloid");this.outcrud=this.unique(this.outcrud.concat(t),"whseYarninDtloid"),this.outcrud.forEach(function(t,i){t.index=i+1,t.equId=e.outform.equId,t.equName=e.outform.equName,t.refCode=e.outform.refCode,t.refName=e.outform.refName}),this.sxclose()},planclose:function(){this.canSave=!0,this.outcrud=[],this.planV=!1},sxclose:function(){this.outcrudOp.column[2].hide="1"!==this.hide,this.outcrudOp.column[3].hide="1"!==this.hide,this.outcrudOp.column[4].hide="2"!==this.hide,this.outcrudOp.column[5].hide="2"!==this.hide,this.outcrudOp.selection=!1,this.outcrudOp.showSummary=!0,this.outcrudOp.height="calc(100vh - 300px)",this.sxV=!1},delDetail:function(){if(o()(this.sxcheck).length>0){for(var e=0;e<this.outcrud.length;e++)if(this.outcrud[e].index===this.sxcheck.index)return this.outcrud.splice(e,1),void this.$refs.outcrud1.setCurrentRow(this.outcrud[0])}else this.$tip.error("請選擇明細資料!")},add:function(){},cellDetailClick:function(e){this.sxcheck=e},cellClick:function(e){this.chooseData=e},close:function(){this.$emit("close")},del:function(){},save:function(){var e=this;this.outloading=!0,addSx(this.outform).then(function(t){0===e.outcrud.length&&(e.$tip.success("保存成功"),e.canSave=!1,e.$emit("save2reset"),e.outloading=!1),e.outcrud.forEach(function(i,a){i.yarnsName=i.$yarnsName,i.whseRetyarninFk=t.data.data,addSxDetali(i).then(function(t){a===e.outcrud.length-1&&(e.$tip.success("保存成功"),e.canSave=!1,e.$emit("save2reset"),e.outloading=!1)})})})},unique:function(e,t){var i=new h.a;return e.filter(function(e){return!i.has(e[t])&&i.set(e[t],1)})},getNowTime:function(){var e=new Date,t=e.getFullYear(),i=e.getMonth()+1,a=e.getDate(),o=e.getHours(),l=e.getMinutes(),s=e.getSeconds();return t+"-"+(i=i<10?"0"+i:i)+"-"+(a=a<10?"0"+a:a)+" "+(o=o<10?"0"+o:o)+":"+(l=l<10?"0"+l:l)+":"+(s=s<10?"0"+s:s)},updateList:function(){this.$emit("save2reset")}},created:function(){this.datas.type="领料单"},mounted:function(){this.outcrudOp=f(this)},beforeDestroy:function(){}},de={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"outPlan"}},[i("div",{staticClass:"btnList"},[i("el-button",{attrs:{type:"warning"},on:{click:function(t){e.ruleV=!0}}},[e._v("編號規則配置")]),e._v(" "),i("el-button",{attrs:{type:"success"},on:{click:e.outOrder}},[e._v("生成出庫單")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.getData}},[e._v("查询")]),e._v(" "),i("el-button",{attrs:{type:"warning"},on:{click:e.close}},[e._v("关闭")])],1),e._v(" "),i("div",{staticClass:"formBox"},[i("avue-form",{ref:"form",attrs:{option:e.formOp},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1),e._v(" "),i("el-row",{staticClass:"crudBox"},[i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"crud",staticStyle:{"margin-top":"-5px"},attrs:{id:"crud",option:e.crudOp,data:e.crud,page:e.page},on:{"update:page":function(t){e.page=t},"on-load":e.getData,"current-row-change":e.cellClick}})],1),e._v(" "),e.planV?i("el-dialog",{attrs:{id:"sxPlanDlg",visible:e.planV,fullscreen:"","append-to-body":"","close-on-click-modal":!1,"before-close":e.planclose},on:{"update:visible":function(t){e.planV=t}}},[e.planV?i("tem",{ref:"tem",attrs:{datas:e.datas,everyThing:e.everyThing,hide:e.hide,detail:e.chooseData,PlanForm:e.chooseData,isPlan:!0},on:{close:function(t){e.planV=!1},updateList:e.updateList}}):e._e()],1):e._e(),e._v(" "),e.ruleV?i("el-dialog",{attrs:{id:"wkRuleDlg",visible:e.ruleV,"append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.ruleV=t}}},[i("rule-dlg",{ref:"rule",attrs:{rcType:"whse_Out_calico"},on:{close:function(t){e.ruleV=!1}}})],1):e._e()],1)},staticRenderFns:[]};var ue=i("VU/8")(re,de,!1,function(e){i("nj6c")},null,null).exports,pe={name:"",components:{temDlg:ce,ruleDlg:he.a,tabPlan:ue,choice:b.a},data:function(){return{dialogVisible:!1,loading:!1,data:JSON.parse(localStorage.getItem("imWk")),page:{pageSize:10,currentPage:1,total:0},hide:JSON.parse(localStorage.getItem("imWk")).type.split("_")[1],formOp:{},form:{},crudOp:{},crud:[],detail:{},everyThing:{},oldData:{},chooseData:{},changeList:[],tabs:"tabs1",ruleV:!1,temV:!1,choiceV:!1,choiceTle:"选择货运计划",choiceTarget:{},choiceField:"",choiceQ:{}}},watch:{},methods:{getData:function(){var e,t,i=this;for(var a in this.loading=!0,this.changeList=[],this.everyThing={mainF:(e=this,{submitBtn:!1,emptyBtn:!1,labelWidth:130,column:[{label:"出仓编号",prop:"retCode",span:6,placeholder:" ",display:"6"!==e.hide},{label:"出倉日期",prop:"retDate",span:6,placeholder:" ",type:"datetime",display:"6"!==e.hide,format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss"},{label:"出倉单号",prop:"woOutno",span:6,placeholder:" ",display:"6"===e.hide},{label:"出倉日期",prop:"woDate",span:6,placeholder:" ",type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",display:"6"===e.hide},{label:"配料编号",prop:"retBatch",span:6,placeholder:" ",display:"1"===e.hide||"2"===e.hide},{label:"货运计划编号",prop:"spNo",span:6,placeholder:" ",display:"6"===e.hide},{label:"财务状态",prop:"finStatus",span:6,placeholder:" ",type:"select",dicData:Object(p.a)("whse_finStatus"),display:"6"===e.hide},(t={label:"操作员",prop:"retUsername",display:!1,span:6,placeholder:" ",type:"select"},u()(t,"display","6"!=e.hide),u()(t,"dicData",Object(p.d)("ucmlUserList","employeename","employeename")),t)]}),mainC:function(e){return{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,height:"calc(100vh - 287px)",refreshBtn:!1,columnBtn:!1,page:!0,column:[{label:"whseMaterialoid",prop:"whseMaterialoid",hide:!0},{label:"序号",prop:"index",width:60,align:"center"},{label:"创建日期",prop:"sysCreated",hide:!0,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(t){e.iptChange(e.chooseData)},align:"center",change:function(t){""===t.value&&e.iptChange(e.chooseData)}},{label:"记录删除标记",prop:"sysDeleted",hide:!0},{label:"出仓编号",prop:"retCode",cell:!0,width:180,change:function(t){e.iptChange(e.chooseData)},hide:"6"===e.hide},u()({label:"出倉单号",prop:"woOutno",cell:!0,width:180,change:function(t){e.iptChange(e.chooseData)},hide:"6"!=e.hide},"change",function(t){e.iptChange(e.chooseData)}),{label:"出倉类型",prop:"retType",cell:!1,width:90,type:"select",dicData:Object(p.a)("Whse_out_type"),change:function(t){e.iptChange(e.chooseData)},hide:"6"===e.hide},{label:"出倉日期",prop:"retDate",cell:!0,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(t){e.iptChange(e.chooseData)},change:function(t){""===t.value&&e.iptChange(e.chooseData)},align:"center",width:200,hide:"6"===e.hide},{label:"出倉日期",prop:"woDate",cell:!0,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(t){e.iptChange(e.chooseData)},change:function(t){""===t.value&&e.iptChange(e.chooseData)},align:"center",hide:"6"!=e.hide,width:200},{label:"货运计划编号",prop:"spNo",span:6,cell:!0,width:200,hide:"6"!==e.hide,click:function(){e.choiceV=!e.choiceV,e.choiceField="spNo",e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.choiceTle="货运计划编号"},change:function(t){""===t.value&&e.iptChange(e.chooseData)}},{label:"调入仓",prop:"traIn",cell:!0,width:120,hide:"5"!==e.hide,change:function(t){""===t.value&&e.iptChange(e.chooseData)},click:function(){e.iptChange(e.chooseData)},type:"select",dicData:Object(p.b)("whseWarehouse","warehouseName","whseWarehouseoid")},{label:"调出仓",prop:"traOut",cell:!0,width:120,hide:"5"!==e.hide,change:function(t){""===t.value&&e.iptChange(e.chooseData)},type:"select",dicData:Object(p.b)("whseWarehouse","warehouseName","whseWarehouseoid"),click:function(){e.iptChange(e.chooseData)}},{label:"配料编号",prop:"retBatch",cell:!1,width:180,hide:"1"!==e.hide&&"2"!==e.hide,change:function(t){""===t.value&&e.iptChange(e.chooseData)},click:function(){e.iptChange(e.chooseData)}},{label:"操作员",prop:"retUsername",cell:!0,width:140,type:"select",dicData:Object(p.d)("ucmlUserList","employeename","employeename"),hide:"6"===e.hide},{label:"财务状态",prop:"finStatus",span:6,cell:!0,placeholder:" ",type:"select",dicData:Object(p.a)("whse_finStatus"),hide:"6"!=e.hide,width:120}]}}(this),dlgF1:g,dlgC1:f(this),dlgC2:{},dlgPp:"24:0",func:C,addF:O,delF:_,updateF:k},"3"!==this.hide&&"4"!==this.hide||(this.everyThing.func=z,this.everyThing.addF=Q,this.everyThing.delF=J,this.everyThing.updateF=Y),"5"===this.hide&&(this.everyThing.func=Z,this.everyThing.addF=A,this.everyThing.delF=te,this.everyThing.updateF=ee),"6"===this.hide&&(this.everyThing.func=S,this.everyThing.addF=L,this.everyThing.delF=B,this.everyThing.updateF=$),this.form)""===this.form[a]&&delete this.form[a];this.everyThing.func(s()(this.form,{rows:this.page.pageSize,start:this.page.currentPage,retType:JSON.parse(localStorage.getItem("imWk")).type.split("_")[1]})).then(function(e){var t=e.data;i.page.total=t.total,i.crud=t.records,0===i.crud.length&&(i.loading=!1),i.crud.forEach(function(e,t){e.finStatus=String(e.finStatus),e.index=t+1,t===i.crud.length-1&&setTimeout(function(){i.loading=!1},200)})}).catch(function(e){i.loading=!1})},add:function(){var e=this;if(!(this.crud.length>0)||this.crud[this.crud.length-1].whseMaterialoid||this.crud[this.crud.length-1].whseCalicoselloutoid||this.crud[this.crud.length-1].whseTransferoid){o()(this.oldData).length>0&&(this.oldData.$cellEdit=!1);var t={index:this.crud.length+1,$cellEdit:!0,retType:this.hide,retCode:"",retDate:this.getNowTime(),woDate:this.getNowTime()};this.crud.push(t),this.$refs.mainCrud.setCurrentRow(this.crud[this.crud.length-1]),this.iptChange(this.crud[this.crud.length-1]),this.oldData=this.crud[this.crud.length-1],this.$nextTick(function(){var t=e;document.getElementsByClassName("el-table__row")[t.crud.length-1].addEventListener("input",function(){t.iptChange(t.oldData)},!1)})}},iptChange:function(e){if(0===this.changeList.length)this.changeList.push(e);else for(var t=0;t<this.changeList.length;t++){if(e.index===this.changeList[t].index)return void(this.changeList[t]=e);this.changeList.length-1===t&&this.changeList[t].index!=e.index&&this.changeList.push(e)}},del:function(){var e=this;if(0!==o()(this.chooseData).length){if(!this.chooseData.whseMaterialoid&&!this.chooseData.whseCalicoselloutoid&&!this.chooseData.whseTransferoid){this.crud.splice(this.chooseData.index-1,1);for(var t=0;t<this.changeList.length;t++)if(this.changeList[t].index===this.chooseData.index)return this.changeList.splice(t,1),void this.$refs.mainCrud.setCurrentRow(this.crud[this.crud.length-1])}this.$tip.cofirm("是否确定删除",this,{}).then(function(){e.everyThing.delF("1"===e.hide||"2"===e.hide?e.chooseData.whseMaterialoid:e.chooseData.whseCalicoselloutoid).then(function(t){200===t.data.code?(e.$tip.success("删除成功"),e.crud.splice(e.chooseData.index-1,1),e.getData()):e.$tip.error("删除失败")}).catch(function(t){e.$tip.error("删除失败!")})}).catch(function(t){e.$tip.warning("取消操作")})}else this.$tip.error("请选择要删除的数据!")},choiceData:function(e){if(0!==o()(e).length){for(var t in this.oldData.$cellEdit=!1,this.choiceTarget[this.choiceField]=e[this.choiceField],this.oldData.$cellEdit=!0,e)delete e[t];for(var t in this.choiceQ)delete this.choiceQ[t];this.choiceV=!1}else this.choiceV=!1},handleRowDBLClick:function(e){this.chooseData.whseCalicoselloutoid||this.chooseData.whseMaterialoid?this.temV=!0:this.$tip.warning("请先保存该出仓数据!")},cellClick:function(e){this.oldData.$cellEdit=!1,this.$set(e,"$cellEdit",!0),this.oldData=e,this.chooseData=e},save:function(){for(var e=this,t=0;t<this.changeList.length;t++){if(!("6"==this.hide||this.changeList[t].retCode&&this.changeList[t].retDate))return void this.$tip.error("出仓编号/日期不能为空!");if(!("6"!==this.hide||this.changeList[t].woOutno&&this.changeList[t].woDate))return void this.$tip.error("出仓编号/日期不能为空!")}this.changeList.forEach(function(t,i){t.whseMaterialoid||t.whseCalicoselloutoid||t.whseTransferoid?e.everyThing.updateF(t).then(function(e){}):e.everyThing.addF(t).then(function(e){})}),this.getData(),this.$tip.success("保存成功!")},close:function(){document.getElementsByClassName("el-dialog__headerbtn")[0].click()},getNowTime:function(){var e=new Date,t=e.getFullYear(),i=e.getMonth()+1,a=e.getDate(),o=e.getHours(),l=e.getMinutes(),s=e.getSeconds();return t+"-"+(i=i<10?"0"+i:i)+"-"+(a=a<10?"0"+a:a)+" "+(o=o<10?"0"+o:o)+":"+(l=l<10?"0"+l:l)+":"+(s=s<10?"0"+s:s)}},created:function(){},mounted:function(){},beforeDestroy:function(){}},ge={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"rc"}},[i("el-tabs",{attrs:{type:"border-card"},model:{value:e.tabs,callback:function(t){e.tabs=t},expression:"tabs"}},[i("el-tab-pane",{attrs:{label:e.data.type.split("_")[0]+"出库",name:"tabs1"}},[i("div",{staticClass:"btnList"},["1"!=e.hide&&"2"!=e.hide?i("el-button",{attrs:{type:"warning"},on:{click:function(t){e.ruleV=!0}}},[e._v("編號規則配置")]):e._e(),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.getData}},[e._v("查询")]),e._v(" "),i("el-button",{attrs:{type:"warning"},on:{click:e.close}},[e._v("关闭")])],1),e._v(" "),i("div",{staticClass:"formBox"},[i("avue-form",{ref:"form",attrs:{option:e.everyThing.mainF},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1),e._v(" "),i("el-row",{staticClass:"crudBox"},[i("el-col",{attrs:{span:24}},[i("view-container",{attrs:{title:e.data.type.split("_")[0]+"出库资料"}},[i("div",{staticClass:"btnList"},["1"!=e.hide&&"2"!=e.hide?i("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("新增")]):e._e(),e._v(" "),i("el-button",{attrs:{type:"danger"},on:{click:e.del}},[e._v("删除")]),e._v(" "),i("el-button",{attrs:{type:"success",disabled:0===e.changeList.length},on:{click:e.save}},[e._v("保存")])],1),e._v(" "),i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"mainCrud",staticStyle:{"margin-top":"-5px"},attrs:{id:"mainCrud",option:e.everyThing.mainC,data:e.crud,page:e.page},on:{"update:page":function(t){e.page=t},"on-load":e.getData,"current-row-change":e.cellClick,"row-dblclick":e.handleRowDBLClick}})],1)],1)],1)],1),e._v(" "),"1"===e.hide||"2"===e.hide?i("el-tab-pane",{attrs:{label:"1"===e.hide?"本厂胚布配料計劃":"外厂胚布配料計劃",name:"tabs2"}},[i("tab-plan",{attrs:{hide:e.hide,datas:e.data,everyThing:e.everyThing,tle:e.data.type.split("_")[0]},on:{close:e.close,save2reset:e.getData}})],1):e._e()],1),e._v(" "),e.ruleV?i("el-dialog",{attrs:{id:"wkRuleDlg",visible:e.ruleV,"append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.ruleV=t}}},[i("rule-dlg",{ref:"rule",attrs:{rcType:"whse_Out_yarn"},on:{close:function(t){e.ruleV=!1}}})],1):e._e(),e._v(" "),e.temV?i("el-dialog",{attrs:{id:"sxrcDlg",visible:e.temV,"append-to-body":"",fullscreen:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.temV=t}}},[i("temDlg",{ref:"temDlg",attrs:{datas:e.data,everyThing:e.everyThing,hide:e.hide,detail:e.chooseData},on:{close:function(t){e.temV=!1}}})],1):e._e(),e._v(" "),e.choiceV?i("choice",{attrs:{choiceV:e.choiceV,choiceTle:e.choiceTle,choiceQ:e.choiceQ,dlgWidth:"60%"},on:{choiceData:e.choiceData,close:function(t){e.choiceV=!1}}}):e._e()],1)},staticRenderFns:[]};var fe=i("VU/8")(pe,ge,!1,function(e){i("+pnf")},null,null);t.default=fe.exports},"4FKk":function(e,t,i){"use strict";t.b=function(e){return{submitBtn:!1,emptyBtn:!1,labelWidth:130,column:[{label:"入仓编号",prop:"yinId",span:6,placeholder:" "},{label:"采购单号",prop:"purNo",span:6,placeholder:" ",display:"2"===e.hide},{label:"送货单号",prop:"deliNo",display:"2"===e.hide,span:6,placeholder:" "},{label:"来胚编号",prop:"registerNo",display:"1"===e.hide,span:6,placeholder:" "},{label:"检验状态",prop:"yinStatus",span:6,placeholder:" ",type:"select",dicData:Object(a.a)("whse_yinstatus")},{label:"入仓日期",prop:"yinDate",span:6,placeholder:" ",type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss"},{label:"财务状态",prop:"finStatus",span:6,display:"1"===e.hide||"2"===e.hide,placeholder:" ",type:"select",dicData:Object(a.a)("whse_finStatus")}]}},t.d=function(e){return{submitBtn:!1,emptyBtn:!1,labelWidth:130,column:[{label:"入仓编号",prop:"yinId",span:6,placeholder:" ",disabled:!0},{label:"入仓日期",prop:"yinDate",span:6,placeholder:" ",type:"datetime",disabled:!0,format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss"},{label:"采购单号",prop:"purNo",span:6,placeholder:" ",disabled:!0,display:"2"==e.hide},{label:"送货单号",prop:"deliNo",span:6,placeholder:" ",disabled:!0,display:"2"===e.hide},{label:"来胚编号",prop:"registerNo",span:6,placeholder:" ",display:"1"===e.hide,disabled:!0},{label:"客戶名称",prop:"custName",cell:!1,display:"1"===e.hide,type:"select",dicData:Object(a.b)("basCustomer","custName","custCode"),span:6,disabled:!0},{label:"检验状态",prop:"yinStatus",span:6,placeholder:" ",type:"select",disabled:!0,dicData:Object(a.a)("whse_yinstatus")},{label:"财务状态",prop:"finStatus",display:"1"===e.hide||"2"===e.hide,span:6,placeholder:" ",type:"select",dicData:Object(a.a)("whse_finStatus"),disabled:!0}]}},t.a=function(e){return{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,height:"1"===e.hide||"2"===e.hide?"calc(100vh - 290px)":"calc(100vh - 300px)",refreshBtn:!1,columnBtn:!1,page:!0,column:[{label:"胚布入仓OID",prop:"whseCalicoinoid",hide:!0},{label:"序号",prop:"index",width:60,align:"center"},{label:"创建日期",prop:"sysCreated",hide:!0,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(t){e.iptChange(e.chooseData)},change:function(t){""===t.value&&e.iptChange(e.chooseData)},align:"center"},{label:"记录删除标记",prop:"sysDeleted",hide:!0},{label:"入仓编号",prop:"yinId",cell:!0,width:200,change:function(t){""===t.value&&e.iptChange(e.chooseData)}},{label:"入仓类型",prop:"yinType",cell:!1,width:160,type:"select",dicData:Object(a.a)("Whse_CalicoType"),change:function(t){e.iptChange(e.chooseData)}},{label:"入仓日期",prop:"yinDate",cell:!0,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(t){e.iptChange(e.chooseData)},change:function(t){""===t.value&&e.iptChange(e.chooseData)},width:190,align:"center"},{label:"採購單號",prop:"purNo",cell:!0,hide:"2"!==e.hide,width:220,placeholder:"請選擇採購單號",click:function(){e.choiceV=!e.choiceV,e.choiceField="purNo",e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.choiceTle="胚布採購單"},change:function(t){""===t.value&&e.iptChange(e.chooseData)}},{label:"送货单号",prop:"deliNo",cell:!0,width:180,hide:"2"!==e.hide,click:function(t){e.chooseData.purNo?(e.choiceV=!e.choiceV,e.choiceQ.deliType="calico",e.choiceField="deliNo",e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.choiceTle="送貨單"):e.$tip.error("請先選擇採購單號！")},change:function(t){""===t.value&&e.iptChange(e.chooseData)}},{label:"来胚编号",prop:"registerNo",cell:!0,width:180,hide:"1"!==e.hide,click:function(t){e.choiceV=!e.choiceV,e.choiceField="registerNo",e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.choiceTle="來胚登記",e.iptChange(e.chooseData)},change:function(t){""===t.value&&e.iptChange(e.chooseData)}},{label:"客戶編號",prop:"custId",cell:!1,hide:"1"!==e.hide,width:150,type:"select",dicData:Object(a.b)("salEmbryogenesis","custCode","registerNo")},{label:"客戶名称",prop:"custName",cell:!1,hide:"1"!==e.hide,type:"select",dicData:Object(a.b)("basCustomer","custName","custCode"),width:150},{label:"检验状态",prop:"yinStatus",cell:!0,width:120,type:"select",dicData:Object(a.a)("whse_yinstatus"),change:function(t){e.iptChange(e.chooseData)}},{label:"加工厂代號",prop:"factoryId",cell:!0,hide:"5"!==e.hide&&"7"!==e.hide,width:150,placeholder:"请选择加工厂代號",click:function(){e.choiceField="factoryId",e.choiceV=!e.choiceV,e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.choiceTle="外厂胚布配料计划",e.iptChange(e.chooseData)}},{label:"加工厂名稱",prop:"factoryName",cell:!1,hide:"5"!==e.hide&&"7"!==e.hide,width:150,type:"select",dicData:Object(a.b)("vWhseMaterialoutPlan","refName","refCode")},{label:"指令单",prop:"instructId",hide:!0},{label:"财务状态",prop:"finStatus",cell:!0,width:120,hide:"1"!==e.hide&&"2"!==e.hide,type:"select",dicData:Object(a.a)("whse_finStatus"),click:function(t){e.iptChange(e.chooseData)}},{label:"创建用户",prop:"sysCreatedby",hide:!0},{label:"授权用户",prop:"sysReplacement",hide:!0},{label:"所属岗位",prop:"sysPostn",hide:!0},{label:"所属部门",prop:"sysDivision",hide:!0},{label:"所属组织",prop:"sysOrg",hide:!0},{label:"最后修改用户",prop:"sysLastUpdBy",hide:!0,width:150},{label:"最后修改日期",prop:"sysLastUpd",hide:!0,type:"datetime",width:180,format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(t){e.iptChange(e.chooseData)},change:function(t){""===t.value&&e.iptChange(e.chooseData)},align:"center"}]}},t.c=function(e){return{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,height:"1"===e.hide||"2"===e.hide?"calc(100vh - 330px)":"calc(100vh - 285px)",refreshBtn:!1,columnBtn:!1,page:!0,roykey:"whseCalicoinDtlaoid",showSummary:!0,sumColumnList:[{label:" ",name:"countingNo",type:"sum"},{label:" ",name:"weight",type:"sum"}],column:[{label:"序号",prop:"index",width:60,align:"center"},{label:"来胚入仓明细OID",prop:"whseCalicoinDtlaoid",hide:!0},{label:"生產單號",prop:"prodNo",cell:!0,width:280,hide:"6"!==e.hide&&"4"!==e.hide&&"7"!==e.hide,placeholder:"請選擇生產單號",click:function(t){e.choiceV=!e.choiceV,e.choiceField="prodNo",e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.iptChange(e.chooseData),"6"!==e.hide&&"7"!==e.hide||(e.choiceTle="胚布貨物包"),"4"===e.hide&&(e.choiceTle="胚布訂單")}},{label:"胚布編碼",prop:"calicoId",cell:"4"!==e.hide,width:140,hide:"6"===e.hide||"7"===e.hide,click:function(t){e.choiceV=!e.choiceV,e.choiceField="calicoId",e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.choiceTle="胚布編碼",e.iptChange(e.chooseData)}},{label:"胚布名称",prop:"clothName",cell:!1,width:450,hide:"6"===e.hide||"7"===e.hide,click:function(t){e.iptChange(e.chooseData)}},{label:"货位码",prop:"locationCode",hide:!0},{label:"客户编号",prop:"custId",cell:!1,width:150,hide:!0},{label:"码卡号",prop:"fabticket",cell:!0,width:220,hide:"6"===e.hide||"4"===e.hide,click:function(t){e.iptChange(e.chooseData)}},{label:"批号",prop:"batchNo",hide:"6"===e.hide||"4"===e.hide||"7"===e.hide,cell:!0,width:150,click:function(t){e.iptChange(e.chooseData)}},{label:"疋數",prop:"countingNo",hide:"4"===e.hide,cell:"6"!=e.hide,width:100,align:"right",click:function(t){e.iptChange(e.chooseData)}},{label:"来胚入仓_FK",prop:"whseCalicoinFk",hide:!0},{label:"重量",prop:"weight",hide:"4"===e.hide||"7"===e.hide,cell:"6"!=e.hide,width:100,align:"right",click:function(t){e.iptChange(e.chooseData)}},{label:"重量单位",prop:"weightUnit",hide:"4"===e.hide||"7"===e.hide,cell:"6"!=e.hide,width:100,type:"select",dicData:Object(a.a)("Whse_Transfer_unit"),click:function(t){e.iptChange(e.chooseData)}}]}},t.e=function(e){return{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,height:"1"===e.hide||"2"===e.hide?"calc(100vh - 330px)":"calc(100vh - 285px)",refreshBtn:!1,columnBtn:!1,page:!0,roykey:"whseCalicoinDtlbOid",showSummary:!0,sumColumnList:[{label:" ",name:"weight",type:"sum"}],column:[{label:"序号",prop:"index",width:60,align:"center"},{label:"来胚入仓批号资料OID",prop:" whseCalicoinDtlbOid",hide:!0},{label:"批号",prop:"batchNo",cell:!0,width:180},{label:"疋号",prop:"countingNo",cell:!0,width:80,align:"right"},{label:"重量",prop:"weight",cell:!0,width:100,align:"right"},{label:"重量单位",prop:"weightUnit",cell:!0,width:100,type:"select",dicData:Object(a.a)("Whse_Transfer_unit")},{label:"客人布票号",prop:"custTicket",cell:!0,width:150}]}};var a=i("2uFj")},Tg7R:function(e,t){},nj6c:function(e,t){}});
//# sourceMappingURL=7.1aea56a12a645bb0caec.js.map