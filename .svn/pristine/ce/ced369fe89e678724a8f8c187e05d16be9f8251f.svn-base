webpackJsonp([19],{"EU+F":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("fZjL"),r=a.n(n),l=a("FGEf"),o=a("2uFj"),i={name:"Ek",components:{},data:function(){return{nowTime:"",websocket:"",timer:{bpSrcoll:"",tbSrcoll:"",tbSrcCtr:1},countDown:"",state:{success:[],going:[],wait:[]},form:{warehouseSn:""},formOp:{labelWidth:110,submitBtn:!1,emptyBtn:!1,column:[{label:"纱线编号",placeholder:" ",prop:"yarnSn",align:"left",readonly:!0,span:8},{label:"纱线名称",placeholder:" ",prop:"yarnName",align:"left",readonly:!0,span:8},{label:"入库日期",placeholder:" ",prop:"yarnDate",type:"date",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",align:"center",width:200,readonly:!0,span:16},{label:"纱批",placeholder:" ",prop:"batchNo",align:"left",readonly:!0,span:8},{label:"纱牌",placeholder:" ",prop:"yarnSign",align:"left",readonly:!0,span:8},{label:"箱数",placeholder:" ",prop:"sum",align:"right",readonly:!0,span:8},{label:"锭数",placeholder:" ",prop:"ingotSum",align:"right",readonly:!0,span:8},{label:"重量",placeholder:" ",prop:"weight",align:"right",readonly:!0,span:8},{label:"实际重量",prop:"actualWeight",placeholder:" ",align:"right",readonly:!0,span:8},{label:"重量单位",prop:"unit",placeholder:" ",readonly:!0,align:"left",span:8},{label:"检验状态",prop:"inspectionStatus",placeholder:" ",align:"left",readonly:!0,span:8},{label:"确认状态",placeholder:" ",prop:"confirmStatus",align:"left",readonly:!0,span:8}]},data:[],option:{page:!1,menu:!1,addBtn:!1,border:!0,height:400,highlightCurrentRow:!0,column:[{label:"序号",prop:"index",width:60,align:"left"},{label:"纱线编号",placeholder:" ",prop:"yarnSn",align:"left",readonly:!0,span:8},{label:"纱线名称",placeholder:" ",prop:"yarnName",align:"left",readonly:!0,span:8},{label:"入库日期",placeholder:" ",prop:"yarnDate",type:"date",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",align:"center",width:200,readonly:!0,span:16},{label:"纱批",placeholder:" ",prop:"batchNo",align:"left",readonly:!0,span:8},{label:"纱牌",placeholder:" ",prop:"yarnSign",align:"left",readonly:!0,span:8},{label:"箱数",placeholder:" ",prop:"sum",align:"right",readonly:!0,span:8},{label:"锭数",placeholder:" ",prop:"ingotSum",align:"right",readonly:!0,span:8},{label:"重量",placeholder:" ",prop:"weight",align:"right",readonly:!0,span:8},{label:"实际重量",prop:"actualWeight",placeholder:" ",align:"right",readonly:!0,span:8},{label:"重量单位",prop:"unit",placeholder:" ",readonly:!0,align:"left",span:8},{label:"检验状态",prop:"inspectionStatus",placeholder:" ",align:"left",readonly:!0,span:8},{label:"确认状态",placeholder:" ",prop:"confirmStatus",align:"left",readonly:!0,span:8}]}}},watch:{},methods:{setWebSoket:function(){o.f.setWebSoket(this);var t=this;t.websocket.onmessage=function(e){var a=JSON.parse(e.data);"null"!==e.data?a.yarnSn&&t.setData(a):t.$tip.warning("暂无该订单信息!")}},chengzhong:function(){""!=this.form.yarnSn&&(this.form.actualWeight=(this.form.weight+1*Math.random()-.5).toFixed(2),this.data[this.form.index-1].actualWeight=this.form.actualWeight,this.form.actualWeight>this.form.weight?(this.data[this.form.index-1].inspectionStatus="通过",this.form.inspectionStatus="通过"):(this.data[this.form.index-1].inspectionStatus="不通过",this.form.inspectionStatus="不通过"))},setData:function(t){for(var e=0;e<this.data.length;e++){if(t.yarnSn===this.data[e].yarnSn&&"getYarn"===t.type)return void this.$tip.error("单号重复!");if(t.yarnSn===this.data[e].yarnSn&&"yarnConfirm"===t.type)return this.data[e].confirmStatus=t.confirmStatus,void this.$tip.success("操作成功!")}t.index=this.data.length+1,this.data.push(t),this.$refs.crud.setCurrentRow(t),this.$nextTick(function(){document.getElementsByClassName("el-table__body-wrapper")[0].scrollTop+=100})},check:function(t){this.form=this.data[t.index-1]},over:function(){for(var t in this.form)this.form[t]="";this.data=[]},submit:function(t){var e=this;r()(this.form).length>0?(this.form.confirmStatus=t,this.data[this.form.index-1].confirmStatus=t,Object(l.d)(this.form).then(function(t){200===t.status&&e.$tip.success("操作成功!")})):this.$tip.error("请选择操作的数据!")},tbSrc:function(){var t=document.getElementsByClassName("el-table__body-wrapper")[0];this.timer.tbSrcCtr>0?t.scrollTop+=20:t.scrollTop-=20,t.scrollTop>=t.scrollHeight-t.clientHeight&&(this.timer.tbSrcCtr=0),t.scrollTop<=0&&(this.timer.tbSrcCtr=1)},cellStyle:function(t){var e=t.row,a=(t.column,t.rowIndex,t.columnIndex);return 11==a?"通过"===e.inspectionStatus?{color:"green",fontWeight:"bold"}:{color:"red",fontWeight:"bold"}:12==a?"通过"===e.confirmStatus?{color:"green",fontWeight:"bold"}:{color:"red",fontWeight:"bold"}:void 0},seTimer:function(){},time:function(){var t,e;t=["星期天","星期一","星期二","星期三","星期四","星期五","星期六"];var a=new Date,n=a.getFullYear(),r=a.getMonth()+1,l=a.getDate(),o=a.getHours(),i=a.getMinutes(),s=a.getSeconds();e=a.getDay(),document.getElementById("time").innerHTML=n+"年"+r+"月"+l+"日\t"+o+":"+i+":"+s+"\t"+t[e]}},created:function(){var t=this;document.onkeydown=function(e){"1"===e.key?t.submit("通过"):"0"===e.key?t.submit("不通过"):"5"===e.key&&t.over()}},mounted:function(){var t=this;this.setWebSoket(),this.$nextTick(function(){t.seTimer()}),this.nowTime=setInterval(this.time,1e3)},beforeDestroy:function(){clearInterval(this.nowTime),clearInterval(this.timer),clearInterval(this.timer.tbSrcoll),this.websocket.close()},destroyed:function(){this.websocket.close()}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"points"}},[a("view-container",{attrs:{title:"纱线点数看板"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"day-Order"},[a("avue-crud",{ref:"crud",attrs:{data:t.data,option:t.option,"cell-style":t.cellStyle},on:{"current-row-change":t.check}},[a("template",{slot:"menuLeft"},[a("span",{staticStyle:{float:"left"},attrs:{id:"time"}})])],2)],1)])],1),t._v(" "),a("el-row",{staticClass:"main"},[a("el-col",{attrs:{span:14}},[a("div",{staticClass:"formTle"},[t._v("\n          胚布信息\n          "),a("el-button",{staticStyle:{padding:"5px 10px","margin-left":"10px"},on:{click:t.chengzhong}},[t._v("模拟称重\n          ")])],1),t._v(" "),a("avue-form",{ref:"form",attrs:{option:t.formOp},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}})],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.form.yarnSn,expression:"form.yarnSn"}],staticClass:"btnList"},[a("el-button",{staticStyle:{background:"green"},on:{click:function(e){return t.submit("通过")}}},[t._v("通过 【1】")]),t._v(" "),a("el-button",{staticStyle:{background:"red"},on:{click:function(e){return t.submit("不通过")}}},[t._v("不通过 【0】")]),t._v(" "),a("el-button",{staticStyle:{background:"rgb(235, 181, 99)"},on:{click:t.over}},[t._v("结束点数 【5】")])],1)])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(i,s,!1,function(t){a("sQCK")},null,null);e.default=c.exports},sQCK:function(t,e){}});
//# sourceMappingURL=19.6472ecc53cd5d28ff424.js.map