webpackJsonp([37],{M4cc:function(t,e){},"V+Yy":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("fZjL"),o=a.n(i),n=a("woOf"),s=a.n(n),l=a("9Z/t"),c={name:"emInfo",components:{},data:function(){var t=this;return{loading:!1,page:{pageSize:10,total:0,currentPage:1},chooseData:{},oldData:{},changeList:[],form:{},formOp:{submitBtn:!1,emptyBtn:!1,column:[{label:"报警时间",prop:"warningDate",span:6,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss"},{label:"处理结果",prop:"doResult",span:6},{label:"处理方式",prop:"doWay",span:6},{label:"处理人员",prop:"whoDoIt",span:6},{label:"设备",span:6,prop:"equipmentId",type:"select",dicData:[{value:"001",label:"交换机1"}]}]},data:[{warningDate:"2020-10-07 12:05:55",picturePath:"/statics/log/img",videoPath:"/statics/log/video",journalPath:"/statics/log",coverDate:"2020-10-07 14:15:18",equipmentId:"001",doResult:"完成",doWay:"人工",whoDoIt:"owt",index:1},{warningDate:"2020-10-07 12:05:55",picturePath:"/statics/log/img",videoPath:"/statics/log/video",journalPath:"/statics/log",coverDate:"2020-10-07 14:15:18",equipmentId:"001",doResult:"完成",doWay:"人工",whoDoIt:"owt",index:1},{warningDate:"2020-10-07 12:05:55",picturePath:"/statics/log/img",videoPath:"/statics/log/video",journalPath:"/statics/log",coverDate:"2020-10-07 14:15:18",equipmentId:"001",doResult:"完成",doWay:"人工",whoDoIt:"owt",index:2},{warningDate:"2020-10-07 12:05:55",picturePath:"/statics/log/img",videoPath:"/statics/log/video",journalPath:"/statics/log",coverDate:"2020-10-07 14:15:18",equipmentId:"001",doResult:"完成",doWay:"人工",whoDoIt:"owt",index:3},{warningDate:"2020-10-07 12:05:55",picturePath:"/statics/log/img",videoPath:"/statics/log/video",journalPath:"/statics/log",coverDate:"2020-10-07 14:15:18",equipmentId:"001",doResult:"完成",doWay:"人工",whoDoIt:"owt",index:4}],crudOp:{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,height:"calc(100vh - 225px)",column:[{label:"序号",prop:"index",width:60},{label:"监控ID",prop:"monitoId",hide:!0},{label:"报警时间",prop:"warningDate",type:"datetime",align:"center",cell:!0,format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(e){t.iptChange(t.chooseData)},change:function(e){null===e.value&&t.iptChange(t.chooseData)}},{label:"图片存储路径",prop:"picturePath",cell:!0},{label:"视频存储路径",prop:"videoPath",cell:!0},{label:"监控日志路径",prop:"journalPath",cell:!0},{label:"存储覆盖时间",prop:"coverDate",type:"datetime",align:"center",cell:!0,format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(e){t.iptChange(t.chooseData)},change:function(e){""===e.value&&t.iptChange(t.chooseData)}},{label:"设备",prop:"equipmentId",type:"select",dicData:[{value:"001",label:"交换机1"}],cell:!0,click:function(e){t.iptChange(t.chooseData)},change:function(e){""===e.value&&t.iptChange(t.chooseData)}},{label:"处理结果",prop:"doResult",cell:!0},{label:"处理方式",prop:"doWay",cell:!0},{label:"处理人员",prop:"whoDoIt",cell:!0}]}}},watch:{},methods:{getData:function(){var t=this;for(var e in this.data=[],this.oldData=[],this.chooseData=[],this.loading=!0,this.form)""===this.form[e]&&delete this.form[e];Object(l.m)(s()(this.form,{page:this.page.currentPage,rows:this.page.pageSize,start:(this.page.currentPage-1)*this.page.pageSize+1})).then(function(e){t.data=e.data.records,t.page.total=e.data.total,t.data.forEach(function(e,a){e.index=a+1;var i=t;i.$nextTick(function(){document.getElementsByClassName("el-table__row")[a].addEventListener("input",function(){i.iptChange(e)},!1)})}),t.loading=!1})},add:function(){var t=this;o()(this.oldData).length>0&&(this.oldData.$cellEdit=!1),this.data.push({index:this.data.length+1,$cellEdit:!0}),this.$refs.crud.setCurrentRow(this.data[this.data.length-1]),this.iptChange(this.data[this.data.length-1]),this.oldData=this.data[this.data.length-1],this.$nextTick(function(){var e=t;document.getElementsByClassName("el-table__row")[e.data.length-1].addEventListener("input",function(){e.iptChange(e.oldData)},!1)})},iptChange:function(t){if(0===this.changeList.length)this.changeList.push(t);else for(var e=0;e<this.changeList.length;e++){if(t.index===this.changeList[e].index)return void(this.changeList[e]=t);this.changeList.length-1===e&&this.changeList[e].index!=t.index&&this.changeList.push(t)}},update:function(){},del:function(){var t=this;0!==o()(this.chooseData).length?this.$tip.cofirm("是否确定删除",this,{}).then(function(){Object(l.g)(t.chooseData.monitoId).then(function(e){200===e.data.code?(t.$tip.success("删除成功"),t.data.splice(t.chooseData.index-1,1)):t.$tip.warning("删除失败")}).catch(function(e){t.$tip.error("删除失败!")})}):this.$tip.error("请选择要删除的数据!")},sava:function(){for(var t=0;t<this.changeList.length;t++)if(!this.changeList[t].equipmentId||!this.changeList[t].warningDate)return void this.$tip.error("设备/报警时间不能为空!");this.changeList.forEach(function(t,e){t.monitoId?Object(l.s)(t).then(function(t){}):Object(l.a)(t).then(function(t){})}),this.getData(),this.$tip.success("保存成功!")},cancel:function(){this.getData()},close:function(){document.getElementsByClassName("el-dialog__headerbtn")[0].click()},cellClick:function(t){this.oldData.$cellEdit=!1,this.$set(t,"$cellEdit",!0),this.oldData=t,this.chooseData=t}},created:function(){},mounted:function(){this.loading=!0},beforeDestroy:function(){}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"emInfo"}},[a("view-container",{attrs:{title:"设备监控信息"}},[a("div",{staticClass:"btnList"},[a("el-button",{attrs:{type:"primary",disabled:t.loading},on:{click:t.add}},[t._v("新增")]),a("el-button",{attrs:{type:"primary",disabled:t.loading},on:{click:t.update}},[t._v("修改")]),a("el-button",{attrs:{type:"danger",disabled:t.loading},on:{click:t.del}},[t._v("删除")]),t._v(" "),a("el-button",{attrs:{type:"success",disabled:t.loading},on:{click:t.sava}},[t._v("保存")]),a("el-button",{attrs:{type:"info",disabled:t.loading},on:{click:t.getData}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",disabled:t.loading},on:{click:t.getData}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{type:"danger",disabled:t.loading},on:{click:t.close}},[t._v("关闭")])],1),t._v(" "),a("div",{staticClass:"formBox"},[a("avue-form",{ref:"form",attrs:{option:t.formOp},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}})],1),t._v(" "),a("div",{staticClass:"crudBox"},[a("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"crud",attrs:{data:t.data,option:t.crudOp,page:t.page},on:{"current-row-change":t.cellClick,"on-load":t.getData,"update:page":function(e){t.page=e}}})],1)])],1)},staticRenderFns:[]};var r=a("VU/8")(c,d,!1,function(t){a("M4cc")},null,null);e.default=r.exports}});
//# sourceMappingURL=37.ef66c4be06007d78582e.js.map