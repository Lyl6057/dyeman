webpackJsonp([13],{"40Fg":function(t,e){},"4FKk":function(t,e,i){"use strict";e.b=function(t){return{submitBtn:!1,emptyBtn:!1,labelWidth:130,column:[{label:"入仓编号",prop:"yinId",span:6,placeholder:" "},{label:"采购单号",prop:"purNo",span:6,placeholder:" ",display:"2"===t.hide},{label:"送货单号",prop:"deliNo",display:"2"===t.hide,span:6,placeholder:" "},{label:"来胚编号",prop:"registerNo",display:"1"===t.hide,span:6,placeholder:" "},{label:"检验状态",prop:"yinStatus",span:6,placeholder:" ",type:"select",dicData:Object(a.a)("whse_yinstatus")},{label:"入仓日期",prop:"yinDate",span:6,placeholder:" ",type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss"},{label:"财务状态",prop:"finStatus",span:6,display:"1"===t.hide||"2"===t.hide,placeholder:" ",type:"select",dicData:Object(a.a)("whse_finStatus")}]}},e.d=function(t){return{submitBtn:!1,emptyBtn:!1,labelWidth:130,column:[{label:"入仓编号",prop:"yinId",span:6,placeholder:" ",disabled:!0},{label:"入仓日期",prop:"yinDate",span:6,placeholder:" ",type:"datetime",disabled:!0,format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss"},{label:"采购单号",prop:"purNo",span:6,placeholder:" ",disabled:!0,display:"2"==t.hide},{label:"送货单号",prop:"deliNo",span:6,placeholder:" ",disabled:!0,display:"2"===t.hide},{label:"来胚编号",prop:"registerNo",span:6,placeholder:" ",display:"1"===t.hide,disabled:!0},{label:"客戶名称",prop:"custName",cell:!1,display:"1"===t.hide,type:"select",dicData:Object(a.b)("basCustomer","custName","custCode"),span:6,disabled:!0},{label:"检验状态",prop:"yinStatus",span:6,placeholder:" ",type:"select",disabled:!0,dicData:Object(a.a)("whse_yinstatus")},{label:"财务状态",prop:"finStatus",display:"1"===t.hide||"2"===t.hide,span:6,placeholder:" ",type:"select",dicData:Object(a.a)("whse_finStatus"),disabled:!0}]}},e.a=function(t){return{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,height:"1"===t.hide||"2"===t.hide?"calc(100vh - 290px)":"calc(100vh - 300px)",refreshBtn:!1,columnBtn:!1,page:!0,column:[{label:"胚布入仓OID",prop:"whseCalicoinoid",hide:!0},{label:"序号",prop:"index",width:60,align:"center"},{label:"创建日期",prop:"sysCreated",hide:!0,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(e){t.iptChange(t.chooseData)},change:function(e){""===e.value&&t.iptChange(t.chooseData)},align:"center"},{label:"记录删除标记",prop:"sysDeleted",hide:!0},{label:"入仓编号",prop:"yinId",cell:!0,width:200,change:function(e){""===e.value&&t.iptChange(t.chooseData)}},{label:"入仓类型",prop:"yinType",cell:!1,width:160,type:"select",dicData:Object(a.a)("Whse_CalicoType"),change:function(e){t.iptChange(t.chooseData)}},{label:"入仓日期",prop:"yinDate",cell:!0,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(e){t.iptChange(t.chooseData)},change:function(e){""===e.value&&t.iptChange(t.chooseData)},width:190,align:"center"},{label:"採購單號",prop:"purNo",cell:!0,hide:"2"!==t.hide,width:220,placeholder:"請選擇採購單號",click:function(){t.choiceV=!t.choiceV,t.choiceField="purNo",t.oldData=t.chooseData,t.choiceTarget=t.oldData,t.choiceTle="胚布採購單"},change:function(e){""===e.value&&t.iptChange(t.chooseData)}},{label:"送货单号",prop:"deliNo",cell:!0,width:180,hide:"2"!==t.hide,click:function(e){t.chooseData.purNo?(t.choiceV=!t.choiceV,t.choiceQ.deliType="calico",t.choiceField="deliNo",t.oldData=t.chooseData,t.choiceTarget=t.oldData,t.choiceTle="送貨單"):t.$tip.error("請先選擇採購單號！")},change:function(e){""===e.value&&t.iptChange(t.chooseData)}},{label:"来胚编号",prop:"registerNo",cell:!0,width:180,hide:"1"!==t.hide,click:function(e){t.choiceV=!t.choiceV,t.choiceField="registerNo",t.oldData=t.chooseData,t.choiceTarget=t.oldData,t.choiceTle="來胚登記",t.iptChange(t.chooseData)},change:function(e){""===e.value&&t.iptChange(t.chooseData)}},{label:"客戶編號",prop:"custId",cell:!1,hide:"1"!==t.hide,width:150,type:"select",dicData:Object(a.b)("salEmbryogenesis","custCode","registerNo")},{label:"客戶名称",prop:"custName",cell:!1,hide:"1"!==t.hide,type:"select",dicData:Object(a.b)("basCustomer","custName","custCode"),width:150},{label:"检验状态",prop:"yinStatus",cell:!0,width:120,type:"select",dicData:Object(a.a)("whse_yinstatus"),change:function(e){t.iptChange(t.chooseData)}},{label:"加工厂代號",prop:"factoryId",cell:!0,hide:"5"!==t.hide&&"7"!==t.hide,width:150,placeholder:"请选择加工厂代號",click:function(){t.choiceField="factoryId",t.choiceV=!t.choiceV,t.oldData=t.chooseData,t.choiceTarget=t.oldData,t.choiceTle="外厂胚布配料计划",t.iptChange(t.chooseData)}},{label:"加工厂名稱",prop:"factoryName",cell:!1,hide:"5"!==t.hide&&"7"!==t.hide,width:150,type:"select",dicData:Object(a.b)("vWhseMaterialoutPlan","refName","refCode")},{label:"指令单",prop:"instructId",hide:!0},{label:"财务状态",prop:"finStatus",cell:!0,width:120,hide:"1"!==t.hide&&"2"!==t.hide,type:"select",dicData:Object(a.a)("whse_finStatus"),click:function(e){t.iptChange(t.chooseData)}},{label:"创建用户",prop:"sysCreatedby",hide:!0},{label:"授权用户",prop:"sysReplacement",hide:!0},{label:"所属岗位",prop:"sysPostn",hide:!0},{label:"所属部门",prop:"sysDivision",hide:!0},{label:"所属组织",prop:"sysOrg",hide:!0},{label:"最后修改用户",prop:"sysLastUpdBy",hide:!0,width:150},{label:"最后修改日期",prop:"sysLastUpd",hide:!0,type:"datetime",width:180,format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(e){t.iptChange(t.chooseData)},change:function(e){""===e.value&&t.iptChange(t.chooseData)},align:"center"}]}},e.c=function(t){return{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,height:"1"===t.hide||"2"===t.hide?"calc(100vh - 330px)":"calc(100vh - 285px)",refreshBtn:!1,columnBtn:!1,page:!0,roykey:"whseCalicoinDtlaoid",showSummary:!0,sumColumnList:[{label:" ",name:"countingNo",type:"sum"},{label:" ",name:"weight",type:"sum"}],column:[{label:"序号",prop:"index",width:60,align:"center"},{label:"来胚入仓明细OID",prop:"whseCalicoinDtlaoid",hide:!0},{label:"生產單號",prop:"prodNo",cell:!0,width:280,hide:"6"!==t.hide&&"4"!==t.hide&&"7"!==t.hide,placeholder:"請選擇生產單號",click:function(e){t.choiceV=!t.choiceV,t.choiceField="prodNo",t.oldData=t.chooseData,t.choiceTarget=t.oldData,t.iptChange(t.chooseData),"6"!==t.hide&&"7"!==t.hide||(t.choiceTle="胚布貨物包"),"4"===t.hide&&(t.choiceTle="胚布訂單")}},{label:"胚布編碼",prop:"calicoId",cell:"4"!==t.hide,width:140,hide:"6"===t.hide||"7"===t.hide,click:function(e){t.choiceV=!t.choiceV,t.choiceField="calicoId",t.oldData=t.chooseData,t.choiceTarget=t.oldData,t.choiceTle="胚布編碼",t.iptChange(t.chooseData)}},{label:"胚布名称",prop:"clothName",cell:!1,width:450,hide:"6"===t.hide||"7"===t.hide,click:function(e){t.iptChange(t.chooseData)}},{label:"货位码",prop:"locationCode",hide:!0},{label:"客户编号",prop:"custId",cell:!1,width:150,hide:!0},{label:"码卡号",prop:"fabticket",cell:!0,width:220,hide:"6"===t.hide||"4"===t.hide,click:function(e){t.iptChange(t.chooseData)}},{label:"批号",prop:"batchNo",hide:"6"===t.hide||"4"===t.hide||"7"===t.hide,cell:!0,width:150,click:function(e){t.iptChange(t.chooseData)}},{label:"疋數",prop:"countingNo",hide:"4"===t.hide,cell:"6"!=t.hide,width:100,align:"right",click:function(e){t.iptChange(t.chooseData)}},{label:"来胚入仓_FK",prop:"whseCalicoinFk",hide:!0},{label:"重量",prop:"weight",hide:"4"===t.hide||"7"===t.hide,cell:"6"!=t.hide,width:100,align:"right",click:function(e){t.iptChange(t.chooseData)}},{label:"重量单位",prop:"weightUnit",hide:"4"===t.hide||"7"===t.hide,cell:"6"!=t.hide,width:100,type:"select",dicData:Object(a.a)("Whse_Transfer_unit"),click:function(e){t.iptChange(t.chooseData)}}]}},e.e=function(t){return{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,height:"1"===t.hide||"2"===t.hide?"calc(100vh - 330px)":"calc(100vh - 285px)",refreshBtn:!1,columnBtn:!1,page:!0,roykey:"whseCalicoinDtlbOid",showSummary:!0,sumColumnList:[{label:" ",name:"weight",type:"sum"}],column:[{label:"序号",prop:"index",width:60,align:"center"},{label:"来胚入仓批号资料OID",prop:" whseCalicoinDtlbOid",hide:!0},{label:"批号",prop:"batchNo",cell:!0,width:180},{label:"疋号",prop:"countingNo",cell:!0,width:80,align:"right"},{label:"重量",prop:"weight",cell:!0,width:100,align:"right"},{label:"重量单位",prop:"weightUnit",cell:!0,width:100,type:"select",dicData:Object(a.a)("Whse_Transfer_unit")},{label:"客人布票号",prop:"custTicket",cell:!0,width:150}]}};var a=i("2uFj")},"VGA+":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("fZjL"),c=i.n(a),o=i("woOf"),h=i.n(o),n=i("4FKk"),s=i("Tjk1"),l=i("g/wl"),d={props:{datas:Object,detail:Object,hide:String},name:"",components:{choice:s.a},data:function(){return{loading:!1,page:{pageSize:10,currentPage:1,total:0},phPage:{pageSize:10,currentPage:1,total:0},formOp:Object(n.d)(this),mxOp:Object(n.c)(this),countOp:Object(n.e)(this),mx:[{index:1}],count:[{index:""}],ctLoading:!1,form:{},oldData:{},chooseData:{},changeList:[],oldPhData:{},choosPheData:{},changePhList:[],canLeave:!1,choiceV:!1,choiceTle:"來紗登記",choiceTarget:{},choiceField:"",choiceQ:{}}},watch:{},methods:{getDetail:function(){var t=this;this.loading=!0,this.changeList=[],this.mx=[],this.count=[],this.chooseData={},Object(l.B)({rows:this.page.pageSize,start:this.page.currentPage,whseCalicoinFk:this.detail.whseCalicoinoid}).then(function(e){var i=e.data;t.page.total=i.total,t.mx=i.records,t.$refs.mx.setCurrentRow(0),0===t.mx.length&&(t.loading=!1),t.mx.forEach(function(e,i){e.index=i+1,e.custId=t.detail.custName,i===t.mx.length-1&&(t.loading=!1)})})},getPh:function(){var t=this;if(!this.chooseData.whseCalicoinDtlaoid||"6"===this.hide||"7"===this.hide)return this.count=[],void(this.countOp.showSummary=!1);this.ctLoading=!0,this.changePhList=[],Object(l.D)({whseCalicoinDtlaFk:this.chooseData.whseCalicoinDtlaoid,rows:this.phPage.pageSize,start:this.phPage.currentPage}).then(function(e){var i=e.data;t.phPage.total=i.total,t.count=i.records,0===t.count.length&&(t.ctLoading=!1),t.count.forEach(function(e,i){e.index=i+1;var a=t;a.$nextTick(function(){document.getElementById("count").getElementsByClassName("el-table__row")[i].addEventListener("input",function(){a.iptPhChange(e)},!1)}),i===t.count.length-1&&(t.ctLoading=!1)}),t.$nextTick(function(){t.$refs.count.setCurrentRow(),t.countOp.showSummary=!0})})},add:function(){this.mx.length>0&&!this.mx[this.mx.length-1].whseCalicoinDtlaoid||(c()(this.oldData).length>0&&(this.oldData.$cellEdit=!1),this.mx.push({index:this.mx.length+1,$cellEdit:!0,custId:this.detail.custName,whseCalicoinFk:this.detail.whseCalicoinoid}),this.$refs.mx.setCurrentRow(this.mx[this.mx.length-1]),this.iptChange(this.mx[this.mx.length-1]),this.oldData=this.mx[this.mx.length-1])},addPh:function(){var t=this;0!==c()(this.chooseData).length?this.chooseData.whseCalicoinDtlaoid?this.count.length>0&&!this.count[this.count.length-1].whseCalicoinDtlboid||(c()(this.oldPhData).length>0&&(this.oldPhData.$cellEdit=!1),this.count.push({index:this.count.length+1,$cellEdit:!0,whseCalicoinDtlaFk:this.chooseData.whseCalicoinDtlaoid,batchNo:this.chooseData.batchNo}),this.$refs.count.setCurrentRow(this.count[this.count.length-1]),this.iptPhChange(this.count[this.count.length-1]),this.oldPhData=this.count[this.count.length-1],this.$nextTick(function(){var e=t;document.getElementById("count").getElementsByClassName("el-table__row")[e.count.length-1].addEventListener("input",function(){e.iptPhChange(e.oldPhData)},!1)})):this.$tip.error("请先保存入库明细资料"):this.$tip.error("请先选择入库明细")},iptChange:function(t){if(0===this.changeList.length)this.changeList.push(t);else for(var e=0;e<this.changeList.length;e++){if(t.index===this.changeList[e].index)return void(this.changeList[e]=t);this.changeList.length-1===e&&this.changeList[e].index!=t.index&&this.changeList.push(t)}},iptPhChange:function(t){if(0===this.changePhList.length)this.changePhList.push(t);else for(var e=0;e<this.changePhList.length;e++){if(t.index===this.changePhList[e].index)return void(this.changePhList[e]=t);this.changePhList.length-1===e&&this.changePhList[e].index!=t.index&&this.changePhList.push(t)}},del:function(){var t=this;if(0!==c()(this.chooseData).length){if(!this.chooseData.whseCalicoinDtlaoid){this.mx.splice(this.chooseData.index-1,1);for(var e=0;e<this.changeList.length;e++)if(this.changeList[e].index===this.chooseData.index)return this.changeList.splice(e,1),void this.$refs.mx.setCurrentRow(this.mx[this.mx.length-1]||{})}var i="";i="6"!=this.hide?"是否确定删除胚布编码为 【 "+this.chooseData.calicoId+" 】 的数据?":"是否确定删除生產單號为 【 "+this.chooseData.prodNo+" 】 的数据?",this.$tip.cofirm(i,this,{}).then(function(){Object(l.p)(t.chooseData.whseCalicoinDtlaoid).then(function(e){200===e.data.code?(t.$tip.success("删除成功"),t.mx.splice(t.chooseData.index-1,1),t.getDetail()):t.$tip.error("删除失败")}).catch(function(e){t.$tip.error("删除失败!")})}).catch(function(e){t.$tip.warning("取消操作")})}else this.$tip.error("请选择要删除的数据!")},delPh:function(){var t=this;if(0!==c()(this.choosePhData).length){if(!this.choosePhData.whseCalicoinDtlboid){this.count.splice(this.choosePhData.index-1,1);for(var e=0;e<this.changePhList.length;e++)if(this.changePhList[e].index===this.choosePhData.index)return this.changePhList.splice(e,1),void this.$refs.count.setCurrentRow(this.count[this.count.length-1]||{})}this.$tip.cofirm("是否确定删除批号为 【 "+this.choosePhData.batchNo+" 】 的数据?",this,{}).then(function(){Object(l.q)(t.choosePhData.whseCalicoinDtlboid).then(function(e){200===e.data.code?(t.$tip.success("删除成功"),t.count.splice(t.choosePhData.index-1,1),t.getPh()):t.$tip.error("删除失败")}).catch(function(e){t.$tip.error("删除失败!")})}).catch(function(e){t.$tip.warning("取消操作")})}else this.$tip.error("请选择要删除的数据!")},cellClick:function(t){var e=this;if(this.canLeave)return this.oldData.$cellEdit=!1,this.$set(t,"$cellEdit",!0),this.oldData=t,this.chooseData=t,void(this.canLeave=!1);this.changePhList.length>0?this.$tip.cofirm("是否保存当前修改的批号资料?",this,{}).then(function(){e.savePh(),e.$nextTick(function(){e.$refs.mx.setCurrentRow(e.oldData)})}).catch(function(i){e.oldData.$cellEdit=!1,e.$set(t,"$cellEdit",!0),e.oldData=t,e.chooseData=t,e.getPh()}):(this.oldData.$cellEdit=!1,this.$set(t,"$cellEdit",!0),this.oldData=t,this.chooseData=t,this.getPh())},cellPhClick:function(t){this.oldPhData.$cellEdit=!1,this.$set(t,"$cellEdit",!0),this.oldPhData=t,this.choosePhData=t},save:function(){for(var t=this,e=0;e<this.changeList.length;e++)if(!(this.changeList[e].calicoId&&this.changeList[e].clothName||"6"==this.hide||"7"==this.hide))return void this.$tip.error("胚布编码/胚布名称不能为空!");this.changeList.forEach(function(e,i){e.custId=t.detail.custName,e.whseCalicoinDtlaoid?Object(l.O)(e).then(function(t){}):Object(l.d)(e).then(function(t){})}),this.getDetail(),this.$tip.success("保存成功!")},savePh:function(){for(var t=0;t<this.changePhList.length;t++)if(!this.changePhList[t].batchNo||!this.changePhList[t].countingNo)return this.$tip.error("批号/疋号不能为空!"),void(this.canLeave=!0);this.changePhList.forEach(function(t,e){t.whseCalicoinDtlboid?Object(l.P)(t).then(function(t){}):Object(l.e)(t).then(function(t){})}),this.canLeave=!1,this.getPh(),this.$tip.success("保存成功!")},close:function(){document.getElementsByClassName("el-dialog__headerbtn")[2].click()},choiceData:function(t){if(0!==c()(t).length){for(var e in this.oldData.$cellEdit=!1,this.choiceTarget.yarnsName=t.yarnsId,this.choiceTarget[this.choiceField]=t[this.choiceField],this.oldData.$cellEdit=!0,"胚布訂單"===this.choiceTle&&(this.choiceTarget.prodNo=t.$poNo,this.choiceTarget.calicoId=t.fabId,this.choiceTarget.clothName=t.fabYcount),"胚布編碼"===this.choiceTle&&(this.choiceTarget.clothName=t.$clothName),"胚布貨物包"===this.choiceTle&&("6"===this.hide&&(this.choiceTarget.weight=t.weight,this.choiceTarget.weightUnit=t.weightUnit),this.choiceTarget.prodNo=t.prodNo,this.choiceTarget.fabticket=t.fabticket,this.choiceTarget.countingNo=t.countingNo),t)delete t[e];for(var e in this.choiceQ)delete this.choiceQ[e];this.choiceV=!1}else this.choiceV=!1}},created:function(){},mounted:function(){this.form=this.detail,this.getDetail()},beforeDestroy:function(){}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"rcDetail"}},[i("view-container",{attrs:{title:t.datas.type.split("_")[0]+"入库"}},[i("div",{staticClass:"btnList"},[i("el-button",{attrs:{type:"warning"},on:{click:t.close}},[t._v("关闭")])],1),t._v(" "),i("div",{staticClass:"formBox"},[i("avue-form",{ref:"form",attrs:{option:t.formOp},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}})],1),t._v(" "),i("el-row",{staticClass:"crudBox"},[i("el-col",{attrs:{span:"6"!=t.hide&&"7"!=t.hide?15:24}},[i("view-container",{attrs:{title:t.datas.type.split("_")[0]+"入库明细"}},[i("div",{staticClass:"btnList",staticStyle:{"margin-bottom":"0px"}},[i("el-button",{attrs:{type:"primary"},on:{click:t.add}},[t._v("新增")]),t._v(" "),i("el-button",{attrs:{type:"danger"},on:{click:t.del}},[t._v("删除")]),t._v(" "),i("el-button",{attrs:{type:"success",disabled:0===t.changeList.length},on:{click:t.save}},[t._v("保存")])],1),t._v(" "),i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"mx",attrs:{option:t.mxOp,data:t.mx,page:t.page},on:{"update:page":function(e){t.page=e},"current-row-change":t.cellClick,"on-load":t.getDetail}})],1)],1),t._v(" "),"6"!=t.hide&&"7"!=t.hide?i("el-col",{attrs:{span:9}},[i("view-container",{attrs:{title:t.datas.type.split("_")[0]+"入库批号资料"}},[i("div",{staticClass:"btnList",staticStyle:{"margin-bottom":"0px"}},[i("el-button",{attrs:{type:"primary"},on:{click:t.addPh}},[t._v("新增")]),t._v(" "),i("el-button",{attrs:{type:"danger"},on:{click:t.delPh}},[t._v("删除")]),t._v(" "),i("el-button",{attrs:{type:"success",disabled:0===t.changePhList.length},on:{click:t.savePh}},[t._v("保存")])],1),t._v(" "),i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"count",attrs:{id:"count",option:t.countOp,page:t.phPage,data:t.count},on:{"update:page":function(e){t.phPage=e},"on-load":t.getPh,"current-row-change":t.cellPhClick}})],1)],1):t._e()],1),t._v(" "),t.choiceV?i("choice",{attrs:{choiceV:t.choiceV,choiceTle:t.choiceTle,choiceQ:t.choiceQ,dlgWidth:"60%"},on:{choiceData:t.choiceData,close:function(e){t.choiceV=!1}}}):t._e()],1)],1)},staticRenderFns:[]};var p=i("VU/8")(d,r,!1,function(t){i("d8c5")},null,null).exports,u=i("sLX/"),g=i("gyMJ"),f={name:"",components:{temDlg:p,ruleDlg:u.a,choice:s.a},data:function(){return{dialogVisible:!1,loading:!1,data:JSON.parse(localStorage.getItem("imWk")),page:{pageSize:10,currentPage:1,total:0},hide:JSON.parse(localStorage.getItem("imWk")).type.split("_")[1],formOp:{},form:{},crudOp:{},crud:[],detail:{},everyThing:{},oldData:{},chooseData:{},changeList:[],ruleV:!1,choiceV:!1,choiceTle:"來胚布登記",choiceTarget:{},choiceField:"",choiceQ:{}}},watch:{},methods:{getData:function(){var t=this;for(var e in this.loading=!0,this.oldData={},this.chooseData={},this.changeList=[],this.everyThing={mainF:Object(n.b)(this),mainC:Object(n.a)(this),dlgF1:Object(n.d)(this),dlgC1:n.c,dlgC2:{},dlgPp:"24:0",fc:l.A},this.form)""===this.form[e]&&delete this.form[e];Object(l.A)(h()(this.form,{rows:this.page.pageSize,start:this.page.currentPage,yinType:JSON.parse(localStorage.getItem("imWk")).type.split("_")[1]})).then(function(e){var i=e.data;t.page.total=i.total,t.crud=i.records,t.crud.forEach(function(e,i){e.finStatus=String(e.finStatus),e.index=i+1,e.custId=e.registerNo,e.factoryName=e.factoryId;var a=t;a.$nextTick(function(){document.getElementsByClassName("el-table__row")[i].addEventListener("input",function(){a.iptChange(e)},!1),t.$set(e,"custName",e.$custId),i===t.crud.length-1&&(a.loading=!1)})}),0===t.crud.length&&(t.loading=!1)}).catch(function(e){t.loading=!1})},add:function(){var t=this;if(!(this.crud.length>0)||this.crud[this.crud.length-1].whseCalicoinoid){c()(this.oldData).length>0&&(this.oldData.$cellEdit=!1);var e={index:this.crud.length+1,$cellEdit:!0,yinType:this.hide,yinId:""};Object(g.a)({code:"whse_In_calico"}).then(function(t){e.yinId=t.data.data}),this.crud.push(e),this.$refs.crud.setCurrentRow(this.crud[this.crud.length-1]),this.iptChange(this.crud[this.crud.length-1]),this.oldData=this.crud[this.crud.length-1],this.$nextTick(function(){var e=t;document.getElementsByClassName("el-table__row")[e.crud.length-1].addEventListener("input",function(){e.iptChange(e.oldData)},!1)})}},iptChange:function(t){if(0===this.changeList.length)this.changeList.push(t);else for(var e=0;e<this.changeList.length;e++){if(t.index===this.changeList[e].index)return void(this.changeList[e]=t);this.changeList.length-1===e&&this.changeList[e].index!=t.index&&this.changeList.push(t)}},del:function(){var t=this;if(0!==c()(this.chooseData).length){if(!this.chooseData.whseCalicoinoid){this.crud.splice(this.chooseData.index-1,1);for(var e=0;e<this.changeList.length;e++)if(this.changeList[e].index===this.chooseData.index)return this.changeList.splice(e,1),void this.$refs.crud.setCurrentRow(this.crud[this.crud.length-1]||{})}this.$tip.cofirm("是否确定删除入仓编号为 【 "+this.chooseData.yinId+" 】 的数据?",this,{}).then(function(){Object(l.o)(t.chooseData.whseCalicoinoid).then(function(e){200===e.data.code?(t.$tip.success("删除成功"),t.crud.splice(t.chooseData.index-1,1),t.getData()):t.$tip.error("删除失败")}).catch(function(e){t.$tip.error("删除失败!")})}).catch(function(e){t.$tip.warning("取消操作")})}else this.$tip.error("请选择要删除的数据!")},cellClick:function(t){this.oldData.$cellEdit=!1,this.$set(t,"$cellEdit",!0),this.oldData=t,this.chooseData=t},save:function(){for(var t=0;t<this.changeList.length;t++)if(!this.changeList[t].yinId)return void this.$tip.error("入仓编号不能为空!");this.changeList.forEach(function(t,e){"null"===t.finStatus&&(t.finStatus=""),t.whseCalicoinoid?Object(l.N)(t).then(function(t){}):Object(l.c)(t).then(function(t){})}),this.getData(),this.$tip.success("保存成功!")},close:function(){document.getElementsByClassName("el-dialog__headerbtn")[0].click()},handleRowDBLClick:function(t){this.detail=t,this.dialogVisible=!0},choiceData:function(t){if(0!==c()(t).length){for(var e in this.oldData.$cellEdit=!1,this.choiceTarget[this.choiceField]=t[this.choiceField],this.choiceTarget.custId=t.custCode,this.choiceTarget.custName=t.custCode,"外厂胚布配料计划"===this.choiceTle&&(this.choiceTarget.factoryId=t.refCode,this.choiceTarget.factoryName=t.refCode),this.oldData.$cellEdit=!0,t)delete t[e];for(var e in this.choiceQ)delete this.choiceQ[e];this.choiceV=!1}else this.choiceV=!1}},created:function(){},mounted:function(){},beforeDestroy:function(){}},m={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"rc"}},[i("view-container",{attrs:{title:t.data.type.split("_")[0]}},[i("div",{staticClass:"btnList"},[i("el-button",{attrs:{type:"primary"},on:{click:t.add}},[t._v("新增")]),t._v(" "),i("el-button",{attrs:{type:"danger"},on:{click:t.del}},[t._v("删除")]),t._v(" "),i("el-button",{attrs:{type:"success",disabled:0===t.changeList.length},on:{click:t.save}},[t._v("保存")]),t._v(" "),i("el-button",{attrs:{type:"warning"},on:{click:function(e){t.ruleV=!0}}},[t._v("編號規則配置")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.getData}},[t._v("查询")]),t._v(" "),i("el-button",{attrs:{type:"warning"},on:{click:t.close}},[t._v("关闭")])],1),t._v(" "),i("div",{staticClass:"formBox"},[i("avue-form",{ref:"form",attrs:{option:t.everyThing.mainF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}})],1),t._v(" "),i("el-row",{staticClass:"crudBox"},[i("el-col",{attrs:{span:24}},[i("view-container",{attrs:{title:t.data.type.split("_")[0]+"入库"}},[i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"crud",attrs:{option:t.everyThing.mainC,data:t.crud,page:t.page},on:{"update:page":function(e){t.page=e},"on-load":t.getData,"row-dblclick":t.handleRowDBLClick,"current-row-change":t.cellClick}})],1)],1)],1),t._v(" "),t.dialogVisible?i("el-dialog",{attrs:{id:"sxrcDlg",visible:t.dialogVisible,width:"100%","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("tem-dlg",{ref:"tem",attrs:{datas:t.data,detail:t.detail,hide:t.hide}})],1):t._e(),t._v(" "),t.ruleV?i("el-dialog",{attrs:{id:"wkRuleDlg",visible:t.ruleV,width:"50%","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(e){t.ruleV=e}}},[i("rule-dlg",{ref:"rule",attrs:{rcType:"whse_In_calico"},on:{close:function(e){t.ruleV=!1}}})],1):t._e(),t._v(" "),t.choiceV?i("choice",{attrs:{choiceV:t.choiceV,choiceTle:t.choiceTle,choiceQ:t.choiceQ,dlgWidth:"60%"},on:{choiceData:t.choiceData,close:function(e){t.choiceV=!1}}}):t._e()],1)],1)},staticRenderFns:[]};var b=i("VU/8")(f,m,!1,function(t){i("40Fg")},null,null);e.default=b.exports},d8c5:function(t,e){}});
//# sourceMappingURL=13.517bfde7e53220627ed5.js.map