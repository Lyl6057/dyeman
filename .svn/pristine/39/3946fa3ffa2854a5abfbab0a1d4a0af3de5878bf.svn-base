webpackJsonp([1],{"B/Ow":function(e,t){},"VJ+a":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("fZjL"),c=i.n(a),s=i("woOf"),o=i.n(s),h=i("2uFj");function n(e){return{submitBtn:!1,emptyBtn:!1,labelWidth:130,column:[{label:"入仓编号",prop:"yinId",span:6,placeholder:" ",disabled:!0},{label:"入仓日期",prop:"yinDate",span:6,placeholder:" ",type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",disabled:!0},{label:"采购单号",prop:"purNo",span:6,placeholder:" ",disabled:!0,display:"2"===e.hide},{label:"送货单号",prop:"deliNo",span:6,placeholder:" ",disabled:!0},{label:"外发厂",prop:"factoryId",span:6,placeholder:" ",disabled:!0,display:"4"===e.hide}]}}function l(e){return{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,height:"calc(100vh - 290px)",refreshBtn:!1,columnBtn:!1,page:!0,roykey:"whseAccessoriesinoidDtl",showSummary:!0,sumColumnList:[{label:" ",name:"poQty",type:"sum"}],column:[{prop:"index",label:"序号",width:60,align:"center"},{label:"whseAccessoriesinoidDtl",prop:"whseAccessoriesinoidDtl",hide:!0},{label:"材料编号",prop:"materialNum",cell:!0,width:160,placeholder:"請選擇材料编号",click:function(t){"五金/行政采购"===e.datas.type.split("_")[0]?e.choiceTle="五金":e.choiceTle="生產輔料",e.choiceV=!e.choiceV,e.choiceField="materialNum",e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.iptChange(e.chooseData)}},{label:"材料类型",prop:"materialType",cell:!1,width:90},{label:"批号",prop:"batchNo",cell:!0,width:150,click:function(t){e.iptChange(e.chooseData)}},{label:"数量",prop:"poQty",cell:!0,width:100,align:"right",click:function(t){e.iptChange(e.chooseData)}},{label:"数量单位",prop:"unitQty",cell:!0,width:100,click:function(t){e.iptChange(e.chooseData)},type:"select",dicData:Object(h.a)("bas_matUnit")},{label:"客户编号",prop:"custId",cell:!0,width:120,click:function(t){e.iptChange(e.chooseData)},hide:!0},{label:"Whse_AccessoriesIn_FK",prop:"whseAccessoriesinFk",hide:!0,width:100}]}}var r=i("Tjk1"),d=i("g/wl"),p={props:{datas:Object,everyThing:Object,hide:String},name:"",components:{choice:r.a},data:function(){return{loading:!1,page:{pageSize:10,currentPage:1,total:0},detail:{},formOp:n(this),mxOp:l(this),mx:[],other:[],form:{},oldData:{},chooseData:{},changeList:[],canLeave:!1,choiceV:!1,choiceTle:"來胚布登記",choiceTarget:{},choiceField:"",choiceQ:{}}},watch:{},methods:{getDetail:function(){var e=this;0!==c()(this.detail).length&&this.detail.whseAccessoriesinoid?(this.loading=!0,this.oldData={},this.changeList=[],this.chooseData={},this.mx=[],this.mxOp.showSummary=!1,Object(d.I)({rows:this.page.pageSize,start:this.page.currentPage,whseAccessoriesinFk:this.detail.whseAccessoriesinoid}).then(function(t){var i=t.data;e.page.total=i.total,e.mx=i.records,e.$refs.dlgcrud.setCurrentRow(),0===e.mx.length&&(e.loading=!1),e.mx.forEach(function(t,i){t.index=i+1,t.model=t.materialNum,t.itemspec=t.materialNum,i===e.mx.length-1&&(e.mxOp.showSummary=!0,e.loading=!1)})})):this.mx=[]},add:function(){0!==c()(this.detail).length?this.detail.whseAccessoriesinoid?this.mx.length>0&&!this.mx[this.mx.length-1].whseAccessoriesDtloid||(c()(this.oldData).length>0&&(this.oldData.$cellEdit=!1),this.mx.push({index:this.mx.length+1,$cellEdit:!0,custId:this.detail.custName,whseAccessoriesinFk:this.detail.whseAccessoriesinoid}),this.$refs.dlgcrud.setCurrentRow(this.mx[this.mx.length-1]),this.iptChange(this.mx[this.mx.length-1]),this.oldData=this.mx[this.mx.length-1]):this.$tip.error("请先保存入库资料"):this.$tip.error("请先选择入库资料")},iptChange:function(e){if(0===this.changeList.length)this.changeList.push(e);else for(var t=0;t<this.changeList.length;t++){if(e.index===this.changeList[t].index)return void(this.changeList[t]=e);this.changeList.length-1===t&&this.changeList[t].index!=e.index&&this.changeList.push(e)}},del:function(){var e=this;if(0!==c()(this.chooseData).length){if(!this.chooseData.whseAccessoriesDtloid){this.mx.splice(this.chooseData.index-1,1);for(var t=0;t<this.changeList.length;t++)if(this.changeList[t].index===this.chooseData.index)return this.changeList.splice(t,1),void this.$refs.dlgcrud.setCurrentRow(this.mx[this.mx.length-1])}this.$tip.cofirm("是否确定删除",this,{}).then(function(){Object(d.v)(e.chooseData.whseAccessoriesDtloid).then(function(t){200===t.data.code?(e.$tip.success("删除成功"),e.mx.splice(e.chooseData.index-1,1),e.getDetail()):e.$tip.error("删除失败")}).catch(function(t){e.$tip.error("删除失败!")})}).catch(function(t){e.$tip.warning("取消操作")})}else this.$tip.error("请选择要删除的数据!")},cellClick:function(e){this.oldData.$cellEdit=!1,this.$set(e,"$cellEdit",!0),this.oldData=e,this.chooseData=e},save:function(){for(var e=0;e<this.changeList.length;e++)if(!this.changeList[e].materialNum||!this.changeList[e].batchNo)return this.$tip.error("材料编号/批数不能为空!"),void(this.canLeave=!0);this.changeList.forEach(function(e,t){e.whseAccessoriesDtloid?Object(d.U)(e).then(function(e){}):Object(d.j)(e).then(function(e){})}),this.changeList=[],this.getDetail(),this.$tip.success("保存成功!")},choiceData:function(e){if(0!==c()(e).length){for(var t in"生產輔料"===this.choiceTle?this.choiceTarget.materialType=e.$basProductionaccFk:e.$basAdsuppliesFk?this.choiceTarget.materialType=e.$basAdsuppliesFk:this.choiceTarget.materialType=e.$basHardwareFk,this.oldData.$cellEdit=!1,this.choiceTarget[this.choiceField]=e[this.choiceField],this.choiceTarget.materialNum=e.hardwareId,this.choiceTarget.unitQty=e.msUnit,this.oldData.$cellEdit=!0,e)delete e[t];for(var t in this.choiceQ)delete this.choiceQ[t];this.choiceV=!1}else this.choiceV=!1},close:function(){document.getElementsByClassName("el-dialog__headerbtn")[2].click()}},created:function(){},mounted:function(){this.form=this.detail},beforeDestroy:function(){}},u={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"rcDetail"}},[i("el-row",{},[i("div",{staticClass:"btnList"},[i("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("新增")]),e._v(" "),i("el-button",{attrs:{type:"danger"},on:{click:e.del}},[e._v("删除")]),e._v(" "),i("el-button",{attrs:{type:"success",disabled:0===e.changeList.length},on:{click:e.save}},[e._v("保存")])],1),e._v(" "),i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dlgcrud",staticStyle:{"margin-top":"-5px"},attrs:{option:e.mxOp,data:e.mx,page:e.page},on:{"update:page":function(t){e.page=t},"current-row-change":e.cellClick,"on-load":e.getDetail}})],1),e._v(" "),e.choiceV?i("choice",{attrs:{choiceV:e.choiceV,choiceTle:e.choiceTle,choiceQ:e.choiceQ,dlgWidth:"60%"},on:{choiceData:e.choiceData,close:function(t){e.choiceV=!1}}}):e._e()],1)},staticRenderFns:[]};var g=i("VU/8")(p,u,!1,function(e){i("B/Ow")},null,null).exports,f=i("sLX/"),m=i("gyMJ"),y={name:"",components:{temDlg:g,ruleDlg:f.a,choice:r.a},data:function(){return{dialogVisible:!1,loading:!1,data:JSON.parse(localStorage.getItem("imWk")),page:{pageSize:10,currentPage:1,total:0},hide:JSON.parse(localStorage.getItem("imWk")).type.split("_")[1],formOp:{},form:{},crudOp:{},crud:[],detail:{},everyThing:{},oldData:{},chooseData:{},changeList:[],ruleV:!1,choiceV:!1,choiceTle:"",choiceTarget:{},choiceField:"",choiceQ:{}}},watch:{},methods:{getData:function(){var e,t=this;for(var i in this.loading=!0,this.oldData={},this.chooseData={},this.everyThing={mainF:(e=this,{submitBtn:!1,emptyBtn:!1,labelWidth:130,column:[{label:"入仓编号",prop:"yinId",span:6,placeholder:" "},{label:"入仓日期",prop:"yinDate",span:6,placeholder:" ",type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss"},{label:"采购单号",prop:"purNo",span:6,placeholder:" ",display:"2"===e.hide||"11"===e.hide},{label:"送货单号",prop:"deliNo",span:6,placeholder:" ",display:"2"===e.hide||"11"===e.hide},{label:"加工厂名稱",prop:"factoryId",span:6,placeholder:" ",display:"6"===e.hide,type:"select",dicData:Object(h.b)("vWhseChemicalPlan","refName","refCode")},{label:"检验状态",prop:"yinStatus",span:6,placeholder:" ",display:"2"!=e.hide&&"11"!=e.hide,type:"select",dicData:Object(h.a)("whse_yinstatus")},{label:"财务状态",prop:"finStatus",span:6,placeholder:" ",type:"select",display:"2"!=e.hide&&"11"!=e.hide&&"6"!=e.hide,dicData:Object(h.a)("whse_finStatus")}]}),mainC:function(e){return{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,height:"calc(100vh - 290px)",refreshBtn:!1,columnBtn:!1,page:!0,column:[{label:"成品布入仓主键OID",prop:"whseAccessoriesinoid",hide:!0},{label:"序号",prop:"index",width:60,align:"center"},{label:"创建日期",prop:"sysCreated",hide:!0,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(t){e.iptChange(e.chooseData)},change:function(t){""===t.value&&e.iptChange(e.chooseData)}},{label:"记录删除标记",prop:"sysDeleted",hide:!0},{label:"入仓编号",prop:"yinId",cell:!0,width:160,change:function(t){e.iptChange(e.chooseData)}},{label:"入仓类型",prop:"yinType",cell:!1,width:100,type:"select",dicData:Object(h.a)("Whse_AccessoriesType"),change:function(t){e.iptChange(e.chooseData)}},{label:"入仓日期",prop:"yinDate",cell:!0,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(t){e.iptChange(e.chooseData)},change:function(t){""===t.value&&e.iptChange(e.chooseData)},width:190,align:"center"},{label:"来料登记编号",prop:"registerNo",cell:!0,width:180,change:function(t){e.iptChange(e.chooseData)},placeholder:"請選擇来料编号",click:function(){e.choiceField="registerNo",e.choiceV=!e.choiceV,e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.choiceTle="來輔料登記"},hide:"1"!==e.hide},{label:"客戶編號",prop:"custId",cell:!1,hide:"1"!==e.hide,width:100,type:"select",dicData:Object(h.b)("salIncomacc","custNo","registerNo")},{label:"客戶名称",prop:"custName",cell:!1,hide:"1"!==e.hide,type:"select",dicData:Object(h.b)("basCustomer","custName","custCode"),width:150},{label:"採購單號",prop:"purNo",cell:!0,width:180,hide:"2"!==e.hide&&"11"!==e.hide,change:function(t){e.iptChange(e.chooseData)},click:function(t){"五金/行政采购"===e.data.type.split("_")[0]?e.choiceTle="五金採購單":e.choiceTle="生產輔料採購單",e.choiceV=!e.choiceV,e.choiceField="purNo",e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.iptChange(e.chooseData)}},{label:"送货单号",prop:"deliNo",hide:"2"!==e.hide&&"11"!==e.hide,cell:!0,width:160,change:function(t){e.iptChange(e.chooseData)},click:function(t){e.chooseData.purNo?("五金/行政采购"===e.data.type.split("_")[0]?e.choiceQ.deliType="hardware":e.choiceQ.deliType="materials",e.choiceV=!e.choiceV,e.choiceField="deliNo",e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.choiceTle="送貨單"):e.$tip.error("請先選擇採購單號！")}},{label:"加工厂代號",prop:"factoryId",cell:!0,hide:"6"!==e.hide,width:150,placeholder:"加工厂代號",click:function(){e.choiceField="factoryId",e.choiceV=!e.choiceV,e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.choiceTle="外厂輔料配料计划",e.iptChange(e.chooseData)}},{label:"加工厂名稱",prop:"factoryName",cell:!1,hide:"6"!==e.hide,width:150,type:"select",dicData:Object(h.b)("vWhseChemicalPlan","refName","refCode")},{label:"检验状态",prop:"yinStatus",cell:!0,width:100,type:"select",dicData:Object(h.a)("whse_yinstatus"),change:function(t){""===t.value&&e.iptChange(e.chooseData)},click:function(){e.iptChange(e.chooseData)}},{label:"财务状态",prop:"finStatus",cell:!0,width:100,type:"select",dicData:Object(h.a)("whse_finStatus"),change:function(t){""===t.value&&e.iptChange(e.chooseData)},click:function(){e.iptChange(e.chooseData)}},{label:"备注",prop:"remarks",cell:!0,width:180,hide:!0,change:function(t){e.iptChange(e.chooseData)}},{label:"创建用户",prop:"sysCreatedby",hide:!0},{label:"授权用户",prop:"sysReplacement",hide:!0},{label:"所属岗位",prop:"sysPostn",hide:!0},{label:"所属部门",prop:"sysDivision",hide:!0},{label:"所属组织",prop:"sysOrg",hide:!0},{label:"最后修改用户",prop:"sysLastUpdBy",hide:!0,width:150},{label:"最后修改日期",prop:"sysLastUpd",hide:!0,type:"datetime",width:180,format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(t){e.iptChange(e.chooseData)},change:function(t){""===t.value&&e.iptChange(e.chooseData)},align:"center"}]}}(this),dlgF1:n,dlgC1:l,dlgC2:{},dlgPp:"24:0"},this.form)""===this.form[i]&&delete this.form[i];Object(d.H)(o()(this.form,{rows:this.page.pageSize,start:this.page.currentPage,yinType:JSON.parse(localStorage.getItem("imWk")).type.split("_")[1]})).then(function(e){var i=e.data;t.page.total=i.total,t.crud=i.records,0===t.crud.length&&(t.loading=!1),t.changeList=[],t.$refs.tem.changeList=[],t.crud.forEach(function(e,i){e.finStatus=String(e.finStatus),e.index=i+1,e.factoryName=e.factoryId,e.custId=e.registerNo,t.$refs.crud.setCurrentRow(),i===t.crud.length-1&&(t.$refs.tem.mx=[],t.loading=!1)}),t.$nextTick(function(){t.crud.forEach(function(e,i){t.$set(e,"custName",e.$custId)})})}).catch(function(e){t.loading=!1})},add:function(){var e=this;if(!(this.crud.length>0)||this.crud[this.crud.length-1].whseAccessoriesinoid){c()(this.oldData).length>0&&(this.oldData.$cellEdit=!1);var t={index:this.crud.length+1,$cellEdit:!0,yinType:this.hide,yinId:""};Object(m.a)({code:"whse_In_Accessories"}).then(function(e){t.yinId=e.data.data}),this.crud.push(t),this.$refs.crud.setCurrentRow(this.crud[this.crud.length-1]),this.iptChange(this.crud[this.crud.length-1]),this.oldData=this.crud[this.crud.length-1],this.$nextTick(function(){var t=e;document.getElementsByClassName("el-table__row")[t.crud.length-1].addEventListener("input",function(){t.iptChange(t.oldData)},!1)})}},iptChange:function(e){if(0===this.changeList.length)this.changeList.push(e);else for(var t=0;t<this.changeList.length;t++){if(e.index===this.changeList[t].index)return void(this.changeList[t]=e);this.changeList.length-1===t&&this.changeList[t].index!=e.index&&this.changeList.push(e)}},del:function(){var e=this;if(0!==c()(this.chooseData).length){if(!this.chooseData.whseAccessoriesinoid){this.crud.splice(this.chooseData.index-1,1);for(var t=0;t<this.changeList.length;t++)if(this.changeList[t].index===this.chooseData.index)return this.changeList.splice(t,1),void this.$refs.crud.setCurrentRow(this.crud[this.crud.length-1])}this.$tip.cofirm("是否确定删除",this,{}).then(function(){Object(d.u)(e.chooseData.whseAccessoriesinoid).then(function(t){200===t.data.code?(e.$tip.success("删除成功"),e.crud.splice(e.chooseData.index-1,1),e.getData()):e.$tip.error("删除失败")}).catch(function(t){e.$tip.error("删除失败!")})}).catch(function(t){e.$tip.warning("取消操作")})}else this.$tip.error("请选择要删除的数据!")},cellClick:function(e){var t=this;if(this.$refs.tem.canLeave)return this.oldData.$cellEdit=!1,this.$set(e,"$cellEdit",!0),this.oldData=e,this.chooseData=e,void(this.$refs.tem.canLeave=!1);this.$refs.tem.changeList.length>0?this.$tip.cofirm("是否保存当前修改的批号资料?",this,{}).then(function(){t.$refs.tem.save(),t.$nextTick(function(){t.$refs.crud.setCurrentRow(t.oldData)})}).catch(function(i){t.oldData.$cellEdit=!1,t.$set(e,"$cellEdit",!0),t.oldData=e,t.chooseData=e,t.$refs.tem.detail=e,t.$refs.tem.getDetail()}):(this.oldData.$cellEdit=!1,this.$set(e,"$cellEdit",!0),this.oldData=e,this.chooseData=e,this.$refs.tem.detail=e,this.$refs.tem.getDetail())},save:function(){for(var e=0;e<this.changeList.length;e++)if(!this.changeList[e].yinId||!this.changeList[e].purNo)return void this.$tip.error("入仓编号/採購單號不能为空!");this.changeList.forEach(function(e,t){"null"===e.finStatus&&(e.finStatus=""),e.whseAccessoriesinoid?Object(d.T)(e).then(function(e){}):Object(d.i)(e).then(function(e){})}),this.getData(),this.changeList=[],this.$tip.success("保存成功!")},choiceData:function(e){if(0!==c()(e).length){for(var t in this.oldData.$cellEdit=!1,this.choiceTarget[this.choiceField]=e[this.choiceField],"外厂輔料配料计划"===this.choiceTle&&(this.choiceTarget.factoryId=e.refCode,this.choiceTarget.factoryName=e.refCode),"五金採購單"!==this.choiceTle&&"生產輔料採購單"!==this.choiceTle||(this.choiceTarget.purNo=e.poNo),this.choiceTarget.custId=e.custNo,this.choiceTarget.custName=e.custNo,this.oldData.$cellEdit=!0,e)delete e[t];for(var t in this.choiceQ)delete this.choiceQ[t];this.choiceV=!1}else this.choiceV=!1},close:function(){document.getElementsByClassName("el-dialog__headerbtn")[0].click()}},created:function(){},mounted:function(){},beforeDestroy:function(){}},D={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"rc"}},[i("view-container",{attrs:{title:e.data.type.split("_")[0]}},[i("div",{staticClass:"btnList"},[i("el-button",{attrs:{type:"warning"},on:{click:function(t){e.ruleV=!0}}},[e._v("編號規則配置")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.getData}},[e._v("查询")]),e._v(" "),i("el-button",{attrs:{type:"warning"},on:{click:e.close}},[e._v("关闭")])],1),e._v(" "),i("div",{staticClass:"formBox"},[i("avue-form",{ref:"form",attrs:{option:e.everyThing.mainF},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1),e._v(" "),i("el-row",{staticClass:"crudBox"},[i("el-col",{attrs:{span:14}},[i("view-container",{attrs:{title:e.data.type.split("_")[0]+"入库"}},[i("div",{staticClass:"btnList"},[i("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("新增")]),e._v(" "),i("el-button",{attrs:{type:"danger"},on:{click:e.del}},[e._v("删除")]),e._v(" "),i("el-button",{attrs:{type:"success",disabled:0===e.changeList.length},on:{click:e.save}},[e._v("保存")])],1),e._v(" "),i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"crud",staticStyle:{"margin-top":"-5px"},attrs:{id:"crud",option:e.everyThing.mainC,data:e.crud,page:e.page},on:{"update:page":function(t){e.page=t},"on-load":e.getData,"current-row-change":e.cellClick}})],1)],1),e._v(" "),i("el-col",{attrs:{span:10}},[i("view-container",{attrs:{title:e.data.type.split("_")[0]+"入库明细"}},[i("tem-dlg",{ref:"tem",attrs:{datas:e.data,everyThing:e.everyThing,hide:e.hide}})],1)],1)],1),e._v(" "),e.ruleV?i("el-dialog",{attrs:{id:"wkRuleDlg",visible:e.ruleV,width:"50%","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.ruleV=t}}},[i("rule-dlg",{ref:"rule",attrs:{rcType:"whse_In_Accessories"},on:{close:function(t){e.ruleV=!1}}})],1):e._e(),e._v(" "),e.choiceV?i("choice",{attrs:{choiceV:e.choiceV,choiceTle:e.choiceTle,choiceQ:e.choiceQ,dlgWidth:"60%"},on:{choiceData:e.choiceData,close:function(t){e.choiceV=!1}}}):e._e()],1)],1)},staticRenderFns:[]};var b=i("VU/8")(y,D,!1,function(e){i("w7Y1")},null,null);t.default=b.exports},w7Y1:function(e,t){}});
//# sourceMappingURL=1.3bf27a29ee0fffba93e7.js.map