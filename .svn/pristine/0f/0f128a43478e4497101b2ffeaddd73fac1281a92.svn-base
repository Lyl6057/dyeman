webpackJsonp([4,5],{"+PBG":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("lHA8"),l=i.n(a),n=i("RRpD"),o={name:"",props:{checkData:Array,leftWidth:String},components:{},data:function(){return{dialogVisible:!1,loading:!1,loadingDlg:!1,existData:[],dlgTle:"",controll:{border:!1,full:!1},crudData:[],crudOp:{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,showSummary:!0,sumColumnList:[{label:"共",name:"weight",type:"sum"}],column:[{label:"批号",prop:"batchNo"},{label:"疋号",prop:"countingNo",align:"right"},{label:"车笼id",prop:"boxCarId",hide:!0},{label:"重量",prop:"weight",align:"right"},{label:"单位",prop:"weightUnit"}]},area:{x:50,y:5,list:[]},data:[]}},watch:{},methods:{getData:function(){var t=this;this.loading=!0,Object(n.c)().then(function(e){e.data.forEach(function(e,i){e.isExtreme?(t.area.x=e.maxX,t.area.y=e.maxY):t.area.list.push(e)})}),Object(n.b)().then(function(e){void 0!=t.checkData&&e.data.forEach(function(t,e){}),t.data=t.arrGroup(e.data).sort(function(t,e){return t.axisY-e.axisY}),t.data.forEach(function(t){t.list.sort(function(t,e){return t.axisX===e.axisX?t.axisZ-e.axisZ:t.axisX-e.axisX})})}),void 0!=this.checkData?setTimeout(function(){t.$nextTick(function(){var e=[];t.checkData.forEach(function(t,i){e.push(t.boxCarId)}),(e=new l.a(e)).forEach(function(e){e.split("-")[0];for(var i=e.split("-")[1],a=0;a<t.data[i-1].list.length;a++)e===t.data[i-1].list[a].boxCarId&&(t.data[i-1].list[a].check=!0,t.existData.push(t.data[i-1].list[a].check))})}),t.loading=!1},1500):setTimeout(function(){t.loading=!1},500)},getDetail:function(t){var e=this;t.exist&&(this.loadingDlg=!0,Object(n.a)({boxId:t.boxId}).then(function(t){e.crudData=t.data,e.loadingDlg=!1}))},domSet:function(){document.getElementsByClassName("content")[0].addEventListener("scroll",this.isScroll,!0)},isScroll:function(){var t=document.getElementsByClassName("content")[0],e=document.getElementsByClassName("xBox")[0],i=document.getElementsByClassName("yBox")[0];e.scrollLeft=t.scrollLeft,i.scrollTop=t.scrollTop},arrGroup:function(t){for(var e={},i=[],a=0;a<t.length;a++){var l=t[a];if(e[l.axisY])for(var n=0;n<i.length;n++){var o=i[n];if(o.axisY==l.axisY){o.list.push(l);break}}else i.push({axisY:l.axisY,list:[l]}),e[l.axisY]=l}return i}},created:function(){},mounted:function(){this.getData(),this.domSet()},beforeDestroy:function(){}},s={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"drap",rawName:"v-drap",value:{x:"content",y:"content"},expression:"{ x: 'content', y: 'content' }"}],attrs:{id:"iqGq"}},[i("div",{staticClass:"navigation"},[i("div",{staticClass:"one"},[t._v("一层")]),t._v(" "),i("div",{staticClass:"two"},[t._v("二层")]),t._v(" "),i("div",{staticClass:"controll"},[i("span",[t._v("坐标轴：")]),t._v(" "),i("el-tooltip",{attrs:{content:"坐标轴: "+t.controll.border,placement:"top"}},[i("el-switch",{model:{value:t.controll.border,callback:function(e){t.$set(t.controll,"border",e)},expression:"controll.border"}})],1)],1)]),t._v(" "),i("div",{staticClass:"content"},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"box",style:{width:70*t.area.x+30+"px",height:70*t.area.y+30+"px"}},[t._l(t.data,function(e){return i("div",{key:e.axisY,staticClass:"wareHouse"},t._l(e.list,function(e,a){return i("div",{key:a,staticClass:"cabinet",class:{cabinet_check:e.highLight},style:{marginLeft:(e.axisX>1?70*(e.axisX-1)+10:10)+"px",marginTop:(e.axisZ>1?10:35)+"px",backgroundColor:"1"===e.state?e.check?"red":e.axisZ>1?"#409EFF":"#67C23A":"2"===e.state?"#ccc":"",display:"1"===e.state||"2"===e.state?"":"none",color:"#fff"}},[e.exist?i("el-popover",{attrs:{placement:"top-start",title:t.dlgTle,width:"600",trigger:"click"}},[i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingDlg,expression:"loadingDlg"}],attrs:{data:t.crudData,option:t.crudOp}}),t._v(" "),i("div",{attrs:{slot:"reference"},on:{click:function(i){return t.getDetail(e)}},slot:"reference"},[t._v("\n              "+t._s(e.exist?"✔":"")+"\n            ")])],1):t._e()],1)}),0)}),t._v(" "),i("div",{staticClass:"area"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.controll.border,expression:"controll.border"}],staticClass:"xBox",style:{width:t.leftWidth}},[i("div",{staticClass:"xShaft",style:{width:70*t.area.x+55+"px"}},t._l(t.area.x,function(e,a){return i("div",{key:a},[t._v("\n              "+t._s(e)+"\n            ")])}),0)]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.controll.border,expression:"controll.border"}],staticClass:"yBox"},[i("div",{staticClass:"yShaft",style:{height:70*t.area.y+60+"px"}},t._l(t.area.y,function(e,a){return i("div",{key:a},[t._v("\n              "+t._s(e)+"\n            ")])}),0)]),t._v(" "),t._l(t.area.list,function(e){return i("div",{key:e.name,staticClass:"partition",style:{width:70*(e.endX-e.startX+1)+"px",height:70*(e.endY-e.startY+1)+"px",lineHeight:e.endY-e.startY+1==1?"50px":70*(e.endY-e.startY+1)+"px",top:e.startY>1?70*(e.startY-1)+16+"px":"16px",left:e.startX>1?70*(e.startX-1)+15+"px":"15px",backgroundColor:e.check?"red":""}},[i("div",{style:{minWidth:e.areaName.length>3?"75px":""}},[t._v("\n            "+t._s(e.areaName)+"\n          ")])])})],2)],2)]),t._v(" "),i("el-dialog",{attrs:{title:t.dlgTle,visible:t.dialogVisible,width:"60%","append-to-body":""},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"formBox",staticStyle:{"margin-top":"10px"}},[i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingDlg,expression:"loadingDlg"}],attrs:{data:t.crudData,option:t.crudOp}})],1)])],1)},staticRenderFns:[]};var r=i("VU/8")(o,s,!1,function(t){i("tuuX")},null,null);e.default=r.exports},"2NKK":function(t,e){},"7PO5":function(t,e){},BDhv:function(t,e,i){var a=i("kM2E");a(a.P+a.R,"Set",{toJSON:i("m9gC")("Set")})},ioQ5:function(t,e,i){i("HpRW")("Set")},lHA8:function(t,e,i){t.exports={default:i("pPW7"),__esModule:!0}},oNmr:function(t,e,i){i("9Bbf")("Set")},pPW7:function(t,e,i){i("M6a0"),i("zQR9"),i("+tPU"),i("ttyz"),i("BDhv"),i("oNmr"),i("ioQ5"),t.exports=i("FeBl").Set},ttyz:function(t,e,i){"use strict";var a=i("9C8M"),l=i("LIJb");t.exports=i("qo66")("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return a.def(l(this,"Set"),t=0===t?0:t,t)}},a)},tuuX:function(t,e){},vVvA:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("bOdI"),l=i.n(a),n=i("fZjL"),o=i.n(n),s=i("woOf"),r=i.n(s),c=i("2uFj"),d={submitBtn:!1,emptyBtn:!1,labelWidth:130,column:[{label:"纱线系统编号",prop:"yarnsId",span:6},{label:"纱批/批号",prop:"batchNo",span:6},{label:"纱牌",prop:"yarnsCard",span:6},{label:"客户编号",prop:"custId",span:6}]},h={menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,showSummary:!0,sumColumnList:[{label:"共",name:"cartonNum",type:"sum"},{label:"共",name:"weight",type:"sum"}],height:"calc(100vh - 255px)",column:[{label:"序号",prop:"seqQty",cell:!0,width:60,align:"right"},{label:"纱线入库明细OID",prop:"whseYarninDtloid",hide:!0,width:225},{label:"纱线系统编号",prop:"yarnsId",cell:!0,width:150},{label:"纱批/批号",prop:"batchNo",cell:!0,width:250},{label:"箱数",prop:"cartonNum",cell:!0,width:80,align:"right"},{label:"每箱锭数",prop:"everySpindle",cell:!0,width:100,align:"right"},{label:"尾箱锭数",prop:"tailSpindle",cell:!0,width:100,align:"right"},{label:"重量",prop:"weight",cell:!0,width:80,align:"right"},{label:"重量单位",prop:"weightUnit",cell:!0,width:100,type:"select",dicData:Object(c.a)("Whse_Transfer_unit")},{label:"纱牌",prop:"yarnsCard",cell:!0,width:80},{label:"产地",prop:"placeOrigin",cell:!0,width:80,type:"select",dicData:Object(c.a)("Whse_Origin")},{label:"入库数量",prop:"whseNum",cell:!0,width:100,align:"right"},{label:"客户编号",prop:"custId",cell:!0,width:100},{label:"送货单重量",prop:"cartonWei",cell:!0,width:125,align:"right"},{label:"纱线入库_FK",prop:"whseYarninFk",hide:!0,width:175}]},p={submitBtn:!1,emptyBtn:!1,labelWidth:110,column:[{label:"批号",prop:"batchNo",span:6},{label:"客人布票号",prop:"custTicket",span:6}]},u={menu:!1,addBtn:!1,border:!0,selection:!0,reserveSelection:!0,highlightCurrentRow:!0,selectionWidth:60,showSummary:!0,sumColumnList:[{label:"共",name:"weight",type:"sum"}],height:"calc(100vh - 255px)",column:[{label:"序号",prop:"seqQty",width:60,align:"right"},{label:"来胚入库批号资料OID",prop:"whseCalicoinDtlboid",hide:!0},{label:"来胚入库明细_FK",prop:"whseCalicoinDtlaFk",hide:!0},{label:"批号",prop:"batchNo",cell:!1,width:200},{label:"疋号",prop:"countingNo",cell:!1,align:"right",width:200},{label:"客人布票号",prop:"custTicket",cell:!1,width:200},{label:"重量",prop:"weight",cell:!1,width:105,align:"right"},{label:"重量单位",prop:"weightUnit",cell:!1,width:100,type:"select",dicData:Object(c.a)("Whse_Transfer_unit")},{label:"储存位置",prop:"boxCarId",cell:!1,width:100}]},g={submitBtn:!1,emptyBtn:!1,column:[{label:"缸号",prop:"batchNo",span:6},{label:"布票号",prop:"fabticket",span:6}]},b={menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,showSummary:!0,sumColumnList:[{label:"共",name:"countingNo",type:"sum"}],height:"calc(100vh - 255px)",column:[{label:"序号",prop:"index",width:60,align:"right"},{label:"Whse_FinishedclothIn_dtlOID",prop:"whseFinishedclothinDtloid",hide:!0},{label:"缸号",prop:"batchNo",cell:!0},{label:"疋数",prop:"countingNo",cell:!0,align:"right"},{label:"重量",prop:"weight",cell:!0,align:"right"},{label:"重量单位",prop:"weightUnit",cell:!0,type:"select",dicData:Object(c.a)("Whse_Transfer_unit")},{label:"布票号",prop:"fabticket",cell:!0},{label:"货位码",prop:"locationCode",cell:!0},{label:"成品布入库",prop:"whseFinishedclothinFk",hide:!0}]},f={submitBtn:!1,emptyBtn:!1,column:[{label:"材料编号",prop:"materialNum",span:6},{label:"材料类型",prop:"materialType",span:6},{label:"批号",prop:"batchNo",span:6},{label:"客户编号",prop:"custId",span:6}]},m={menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,showSummary:!0,sumColumnList:[{label:"共",name:"poQty",type:"sum"}],height:"calc(100vh - 255px)",column:[{label:"序号",prop:"seqQty",cell:!0,width:60,align:"right"},{label:"五金/行政/生产辅料入库明细OID",prop:"whseAccessoriesDtloid",hide:!0},{label:"材料编号",prop:"materialNum",cell:!0},{label:"数量",prop:"poQty",cell:!0,align:"right"},{label:"数量单位",prop:"unitQty",cell:!0},{label:"材料类型",prop:"materialType",cell:!0},{label:"批号",prop:"batchNo",cell:!0},{label:"客户编号",prop:"custId",cell:!0},{label:"五金/行政/生产辅料入库_FK",prop:"whseAccessoriesinFk",hide:!0}]},v={submitBtn:!1,emptyBtn:!1,labelWidth:120,column:[{label:"染化料编码",prop:"chemicalId",span:6},{label:"染化料名称",prop:"chemicalName",span:6},{label:"批号",prop:"batchNo",span:6},{label:"客户编号",prop:"custId",span:6}]},w={menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,showSummary:!0,sumColumnList:[{label:"共",name:"weight",type:"sum"}],height:"calc(100vh - 235px)",column:[{label:"序号",prop:"seqQty",cell:!0,width:60,align:"right"},{label:"Whse_ChemicalIn_dtlaOID",prop:"whseChemicalinDtlaoid",hide:!0},{label:"染化料编码",prop:"chemicalId",cell:!0},{label:"染化料名称",prop:"chemicalName",cell:!0},{label:"批号",prop:"batchNo",cell:!0},{label:"重量",prop:"weight",cell:!0,align:"right"},{label:"重量单位",prop:"weightUnit",cell:!0,type:"select",dicData:Object(c.a)("Whse_Transfer_unit")},{label:"客户编号",prop:"custId",cell:!0},{label:"染化料入库",prop:"whseChemicalinFk",hide:!0}]},x=i("mtWM"),y=i.n(x);function C(t){return y()({url:"/api/whseYarninDtl/v1.0/listByPage",method:"get",params:t})}function _(t){return y()({url:"/api/whseCalicoinDtlb/listByPages",method:"get",params:t})}function D(t){return y()({url:"/api/whseFinishedclothinDtl/v1.0/listByPage",method:"get",params:t})}function k(t){return y()({url:"/api/whseChemicalinDtla/v1.0/listByPage",method:"get",params:t})}function I(t){return y()({url:"/api/whseAccessoriesDtl/v1.0/listByPage",method:"get",params:t})}var O=i("+PBG"),N={name:"",props:{type:String,crudData:Array,locInfo:Array},components:{boxLoc:O.default},data:function(){return{loading:!1,pdDlg:!1,logOrPd:"logs",innerVisible:!1,data:[],chengzhong:[],finishList:[],length:1,btn:!0,log:"",queue:[],oldData:{},czsocket:"",pdIndex:0,crudOp:{menu:!1,addBtn:!1,delBtn:!1,editBtn:!1,cancelBtn:!1,menuWidth:90,border:!0,reserveSelection:!0,highlightCurrentRow:!0,height:400,rowKey:"whseCalicoinDtlboid",column:[{label:"#",prop:"index",width:50,align:"right"},{label:"来胚入库批号资料OID",prop:"whseCalicoinDtlboid",hide:!0},{label:"来胚入库明细_FK",prop:"whseCalicoinDtlaFk",hide:!0},{label:"批号",prop:"batchNo",cell:!1,width:180},{label:"疋号",prop:"countingNo",cell:!1,width:150,align:"right"},{label:"客人布票号",prop:"custTicket",cell:!1,width:150,hide:!0},{label:"重量",prop:"weight",cell:!1,width:100,align:"right"},{label:"盘点重量",prop:"caliWeight",cell:!0,width:130,align:"right",hide:!0},{label:"重量单位",prop:"weightUnit",cell:!1,hide:!1,width:110,type:"select",dicData:Object(c.a)("Whse_Transfer_unit")},{label:"通过",prop:"pass",cell:!0,type:"select",hide:!0,dicData:[{value:!1,label:"否"},{value:!0,label:"是"}],width:120},{label:"储存位置",prop:"boxCarId",cell:!1,width:120}]},ydpOp:{menu:!1,addBtn:!1,delBtn:!1,editBtn:!1,cancelBtn:!1,menuWidth:90,border:!0,reserveSelection:!0,highlightCurrentRow:!0,height:"calc(100vh - 650px)",rowKey:"whseCalicoinDtlboid",column:[{label:"#",prop:"index",width:50,align:"right"},{label:"来胚入库批号资料OID",prop:"whseCalicoinDtlboid",hide:!0},{label:"来胚入库明细_FK",prop:"whseCalicoinDtlaFk",hide:!0},{label:"批号",prop:"batchNo",cell:!1,width:150},{label:"疋号",prop:"countingNo",cell:!1,width:100,align:"right"},{label:"客人布票号",prop:"custTicket",cell:!1,width:150,hide:!0},{label:"重量",prop:"weight",cell:!1,width:100,align:"right"},{label:"盘点重量",prop:"caliWeight",cell:!0,width:130,align:"right"},{label:"重量单位",prop:"weightUnit",cell:!0,hide:!1,type:"select",dicData:Object(c.a)("Whse_Transfer_unit"),width:110},{label:"通过",prop:"pass",cell:!0,type:"select",hide:!1,dicData:[{value:!1,label:"否"},{value:!0,label:"是"}],width:100},{label:"储存位置",prop:"boxCarId",width:120}]},oldArea:{},oldCheck:{}}},watch:{},methods:{setCz:function(){c.f.setCz(this);var t=this;t.czsocket.onmessage=function(e){t.$nextTick(function(){setTimeout(function(){t.oldData.caliWeight=e.data,t.oldData.$cellEdit=!1,t.oldData.$cellEdit=!0,t.loading=!1},200)})}},setData:function(){this.data=this.arrGroup(this.crudData)},random:function(t){"number"==typeof t?(this.length=Math.ceil(t*this.data.length),t=this.length):t=this.length,this.queue=[];for(var e=new Array,i=0;i<this.data.length;i++)e[i]=i;e.sort(function(){return.5-Math.random()});for(i=0;i<t;i++)this.data[e[i]].check=!1,this.queue.push(this.data[e[i]])},pandian:function(){var t=this;0!==this.queue.length?this.$tip.cofirm("是否开始盘点流程?",this).then(function(){t.log+="开始盘点,等待 【"+t.queue[0].boxCarId+"】 出库 ···<br/>",t.btn=!1,t.queue[0].state=1,t.queueClick("52-5-1"),t.moniCc(t.queue[0]),t.pdIndex=0}).catch(function(){t.$message({type:"info",message:"已取消删除"})}):this.$tip.warning("请选择盘点货物!")},handleRowDBLClick:function(t){if(0!==this.queue.length)for(var e=0;e<this.queue.length;e++){if(t.boxCarId===this.queue[e].boxCarId)return;if(e===this.queue.length-1&&t.boxCarId!=this.queue[e].boxCarId)return void this.queue.push(t)}else this.queue.push(t)},moniCc:function(t){var e=this;setTimeout(function(){for(var i=0;i<e.$refs.boxLoc.area.list.length;i++)if(e.$refs.boxLoc.area.list[i].areaName==="验布"+(e.pdIndex+1)){e.oldArea=e.$refs.boxLoc.area.list[i],e.$set(e.$refs.boxLoc.area.list[i],"check",!0);break}e.log+="【"+t.boxCarId+"】 出库至【验布1】成功，等待盘点 ···<br/>",e.chengzhong=t.children,e.crudOp.column[0].hide=!0,e.crudOp.column[7].hide=!1,e.crudOp.column[9].hide=!1,e.crudOp.menu=!0,e.innerVisible=!0},2e3)},getWeight:function(){this.loading=!0,this.czsocket.send("msg")},finish:function(){for(var t=0;t<this.chengzhong.length;t++)if(""===this.chengzhong[t].pass||void 0===this.chengzhong[t].pass)return void this.$tip.warning("请选择是否通过！");for(var e=0;e<this.queue.length;e++)if(1===this.queue[this.pdIndex].state){this.queue[this.pdIndex].state=2;break}this.finishList=this.finishList.concat(this.chengzhong),this.finishList.forEach(function(t,e){t.index=e+1}),this.oldData.$cellEdit=!1,this.innerVisible=!1,this.oldArea.check=!1,this.log+="【"+this.queue[this.pdIndex].boxCarId+"】 盘点成功，请重新入库 ···<br/>"},nextPd:function(){void 0!==this.queue[this.pdIndex+1]?(this.log+="开始盘点,等待 【"+this.queue[++this.pdIndex].boxCarId+"】 出库 ···<br/>",this.queue[this.pdIndex].state=1,this.queueClick("52-5-1"),this.moniCc(this.queue[this.pdIndex])):this.$tip.error("无!")},pandianed:function(){this.finishList.forEach(function(t,e){t.index=e+1})},over:function(){var t,e=this;(t=this.finishList,y()({dataType:"json","content-type":"application/json",url:"/api/whsMateInventory/list",method:"post",data:t})).then(function(t){"ok"===t.data&&e.$tip.success("操作成功！")})},delQueue:function(t){this.queue.splice(t,1)},preClose:function(){document.getElementsByClassName("el-dialog__headerbtn")[1].click()},closeBefore:function(){this.crudOp.column[0].hide=!1,this.crudOp.column[7].hide=!0,this.crudOp.column[9].hide=!0,this.crudOp.menu=!1},pdClose:function(){this.crudOp.column[0].prop="#",this.crudOp.column[7].hide=!0,this.crudOp.column[9].hide=!0},queueClick:function(t){this.$set(this.oldCheck,"highLight",!1);t.split("-")[0];for(var e=t.split("-")[1],i=this.$refs.boxLoc.data,a=0;a<i[e-1].list.length;a++)if(t===this.$refs.boxLoc.data[e-1].list[a].boxCarId){this.$set(this.$refs.boxLoc.data[e-1].list[a],"highLight",!0),this.oldCheck=this.$refs.boxLoc.data[e-1].list[a];break}var l=document.getElementsByClassName("content")[0];l.scrollLeft=70*(t.split("-")[0]-9),l.scrollTop=70*(t.split("-")[1]-6)},cellClick:function(t){this.oldData.$cellEdit=!1,this.$set(t,"$cellEdit",!0),this.oldData=t,this.innerVisible||this.queueClick(t.boxCarId)},arrGroup:function(t){for(var e={},i=[],a=0;a<t.length;a++){var n,o=t[a];if(e[o.boxCarId])for(var s=0;s<i.length;s++){var r=i[s];if(r.boxCarId==o.boxCarId){r.children.push(o),r.weight+=o.weight,r.countingNo+=","+o.countingNo;break}}else i.push((n={boxCarId:o.boxCarId},l()(n,"boxCarId",o.boxCarId),l()(n,"whseCalicoinDtlboid",o.boxCarId),l()(n,"children",[o]),l()(n,"countingNo",o.countingNo),l()(n,"batchNo",o.batchNo),l()(n,"weight",o.weight),l()(n,"$cellEdit",!1),n)),e[o.boxCarId]=o}return i}},created:function(){},mounted:function(){this.crudOp.column[10].dicData=this.locInfo,this.ydpOp.column[10].dicData=this.locInfo,this.setData(),this.setCz()},beforeDestroy:function(){this.czsocket.close()}},B={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"preview"}},[i("view-container",{staticStyle:{height:"100%"},attrs:{title:t.type+"盘点预览"}},[i("el-row",[i("el-col",{attrs:{span:10}},[i("div",{staticClass:"btnList"},[i("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:t.btn,expression:"btn"}],attrs:{type:"primary",disabled:t.loading,"split-button":""},on:{click:t.random}},[t._v("随机选择 "+t._s(t.length)+"\n            "),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{nativeOn:{click:function(e){return t.random(.2)}}},[t._v("1/5")]),t._v(" "),i("el-dropdown-item",{nativeOn:{click:function(e){return t.random(.25)}}},[t._v("1/4")]),t._v(" "),i("el-dropdown-item",{nativeOn:{click:function(e){return t.random(1/3)}}},[t._v("1/3")]),t._v(" "),i("el-dropdown-item",{nativeOn:{click:function(e){return t.random(.5)}}},[t._v("1/2")]),t._v(" "),i("el-dropdown-item",{nativeOn:{click:function(e){return t.random(1)}}},[t._v("1/1")])],1)],1),t._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:t.btn,expression:"btn"}],staticStyle:{"margin-left":"10px"},attrs:{type:"primary",disabled:t.loading},on:{click:t.pandian}},[t._v("开始盘点")]),t._v(" "),t.finishList.length>0&&void 0!=t.queue[this.pdIndex+1]?i("el-button",{attrs:{type:"primary"},on:{click:t.nextPd}},[t._v("继续盘点")]):t._e(),t._v(" "),t.finishList.length>0&&void 0===t.queue[this.pdIndex+1]?i("el-button",{attrs:{type:"primary"},on:{click:t.over}},[t._v("生成盈亏记录")]):t._e(),t._v(" "),i("el-button",{attrs:{type:"danger",disabled:t.loading},on:{click:t.preClose}},[t._v("关闭")])],1),t._v(" "),i("div",{staticClass:"crudBox",staticStyle:{"margin-top":"-5px"}},[i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"pandian",attrs:{data:t.data,option:t.crudOp},on:{"current-row-change":t.cellClick,"row-dblclick":t.handleRowDBLClick}})],1),t._v(" "),""!=t.log?i("div",{staticClass:"logBox"},[i("el-tabs",{attrs:{type:"border-card"},model:{value:t.logOrPd,callback:function(e){t.logOrPd=e},expression:"logOrPd"}},[i("el-tab-pane",{attrs:{name:"logs",label:"日志"}},[i("el-input",{attrs:{type:"textarea",rows:13,readonly:""},domProps:{innerHTML:t._s(t.log)},model:{value:t.log,callback:function(e){t.log=e},expression:"log"}})],1),t._v(" "),i("el-tab-pane",{attrs:{name:"pd",label:"已盘点"}},[i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"pandianed",attrs:{data:t.finishList,option:t.ydpOp}})],1)],1)],1):t._e(),t._v(" "),i("div",{staticClass:"queueBox"},[i("div",{staticClass:"queueContent",style:{width:102*t.queue.length+"px"}},t._l(t.queue,function(e,a){return i("div",{key:e.boxId,staticClass:"queueList",style:{backgroundColor:1===e.state?"red":2===e.state?"green":""},on:{click:function(i){return t.queueClick(e.boxCarId)}}},[t._v("\n              "+t._s(e.boxCarId)+"\n              "),2!=e.state?i("span",{staticClass:"delqueue",on:{click:function(e){return e.stopPropagation(),t.delQueue(a)}}},[t._v("X")]):t._e()])}),0)])]),t._v(" "),i("el-col",{attrs:{span:14}},[i("boxLoc",{ref:"boxLoc",attrs:{leftWidth:"calc(100vw - 835px)",checkData:t.crudData}})],1)],1),t._v(" "),i("el-dialog",{staticClass:"pdDlg",attrs:{width:"50%",title:"盘点明细",visible:t.innerVisible,"append-to-body":"","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.innerVisible=e},close:t.closeBefore}},[i("div",{staticClass:"btnList"},[i("el-button",{attrs:{type:"primary",disabled:t.loading},on:{click:t.finish}},[t._v("完成")])],1),t._v(" "),i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"chengzhong",attrs:{data:t.chengzhong,option:t.crudOp},on:{"current-row-change":t.cellClick},scopedSlots:t._u([{key:"menu",fn:function(e){return[i("el-button",{attrs:{type:"primary"},on:{click:t.getWeight}},[t._v("称重")])]}}])})],1)],1)],1)},staticRenderFns:[]};var L={name:"",components:{preview:i("VU/8")(N,B,!1,function(t){i("7PO5")},null,null).exports},data:function(){return{tabs:"sx",dialogVisible:!1,loading:!1,page:{pageSize:10,total:0,currentPage:1},locInfo:[],chooseData:{},oldData:{},changeList:[],form:{},formOp:d,crudData:[{index:1}],func:null,data:{sx:[],pb:[],cpb:[],rhl:[],scfl:[]},crudOp:h,selectionData:[],tle:""}},watch:{tabs:{handler:function(t,e){switch(this.selectionData=[],t){case"sx":this.formOp=d,this.crudOp=h,this.func=C,this.tle="纱线";break;case"pb":this.formOp=p,this.crudOp=u,this.func=_,this.tle="胚布";break;case"cpb":this.formOp=g,this.crudOp=b,this.func=D,this.tle="成品布";break;case"rhl":this.formOp=v,this.crudOp=w,this.tle="染化料",this.func=k;break;default:this.formOp=f,this.crudOp=m,this.func=I,this.tle="生产辅料/五金/行政用品"}this.getData(this.tabs)},deep:!0,immediate:!0}},methods:l()({getData:function(t){var e=this;for(var i in this.loading=!0,this.selectionData.length>0&&(this.selectionData=[],this.$refs.crud1.selectClear()),this.form)""===this.form[i]&&delete this.form[i];this.func(r()(this.form,{rows:this.page.pageSize,start:(this.page.currentPage-1)*this.page.pageSize+1})).then(function(i){i.data.records.forEach(function(t,e){t.seqQty=e+1}),e.data[t]=i.data.records,e.crudData=e.data[t],e.page.total=i.data.total,e.loading=!1}).catch(function(t){e.loading=!1})},add:function(){var t=this;o()(this.oldData).length>0&&(this.oldData.$cellEdit=!1),this.data.push({index:this.data.length+1,$cellEdit:!0}),this.oldData=this.data[this.data.length-1],this.$nextTick(function(){var e=t;document.getElementsByClassName("el-table__row")[e.data.length-1].addEventListener("input",function(){e.iptChange(e.oldData)},!1)})},iptChange:function(t){if(0===this.changeList.length)this.changeList.push(t);else for(var e=0;e<this.changeList.length;e++){if(t.index===this.changeList[e].index)return void(this.changeList[e]=t);this.changeList.length-1===e&&this.changeList[e].index!=t.index&&this.changeList.push(t)}},update:function(){},del:function(){},sava:function(){this.oldData.$cellEdit=!1},cancel:function(){},query:function(){},preview:function(){this.dialogVisible=!0},selectionChange:function(t){this.selectionData=t},close:function(){document.getElementsByClassName("el-dialog__headerbtn")[1].click()}},"del",function(t,e){var i=this,a=t.classifyId;cofirm("此操作将永久删除该文件, 是否继续?","提示",{}).then(function(){i.$axios.delete("/api/iotEquipmentType?classifyId="+a).then(function(t){0==t.data.code?(success("删除成功"),i.handleList()):warning("删除失败")}).catch(function(t){error("服务器错误")})}).catch(function(){i.$message({type:"info",message:"已取消删除"})})}),created:function(){var t,e=this;y()({url:"/api/clothDetaInformation",method:"get",params:t}).then(function(t){u.column[8].dicData=t.data,e.locInfo=t.data})},mounted:function(){},beforeDestroy:function(){}},q={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"imSt"}},[i("view-container",{attrs:{title:"库存盘点"}},[i("div",{staticClass:"btnList"},[i("el-button",{attrs:{type:"primary",disabled:t.loading},on:{click:t.preview}},[t._v("盘点")]),t._v(" "),i("el-button",{attrs:{type:"primary",disabled:t.loading},on:{click:t.getData}},[t._v("查询")])],1),t._v(" "),i("div",{staticClass:"formBox",staticStyle:{"margin-top":"10px"}},[i("avue-form",{ref:"form",attrs:{option:t.formOp},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}})],1),t._v(" "),i("el-card",[i("el-tabs",{attrs:{type:"border-card"},model:{value:t.tabs,callback:function(e){t.tabs=e},expression:"tabs"}},[i("el-tab-pane",{attrs:{label:"纱线",name:"sx"}}),t._v(" "),i("el-tab-pane",{attrs:{label:"胚布",name:"pb"}}),t._v(" "),i("el-tab-pane",{attrs:{label:"成品布",name:"cpb"}}),t._v(" "),i("el-tab-pane",{attrs:{label:"染化料",name:"rhl"}}),t._v(" "),i("el-tab-pane",{attrs:{label:"生产辅料/五金、行政用品",name:"scfl"}})],1),t._v(" "),i("div",{staticClass:"crudBox"},[i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"crud1",attrs:{data:t.crudData,option:t.crudOp,page:t.page},on:{"on-load":function(e){return t.getData(t.tabs)},"update:page":function(e){t.page=e},"selection-change":t.selectionChange}})],1)],1),t._v(" "),t.dialogVisible?i("el-dialog",{attrs:{id:"stDlg",visible:t.dialogVisible,width:"100%","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("preview",{attrs:{type:t.tle,locInfo:t.locInfo,crudData:t.selectionData}})],1):t._e()],1)],1)},staticRenderFns:[]};var S=i("VU/8")(L,q,!1,function(t){i("2NKK")},null,null);e.default=S.exports}});
//# sourceMappingURL=4.9f6a181a4c986eb3361b.js.map