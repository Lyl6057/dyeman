webpackJsonp([9],{HdFe:function(e,t){},QNHF:function(e,t){},V3Oj:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("fZjL"),c=i.n(a),n=i("woOf"),o=i.n(n),h=i("2uFj");function s(e){return{submitBtn:!1,emptyBtn:!1,labelWidth:130,column:[{label:"入仓编号",prop:"yinId",span:6,placeholder:" ",disabled:!0,red:!0},{label:"入仓日期",prop:"yinDate",span:6,placeholder:" ",type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",disabled:!0},{label:"採購單號",prop:"purNo",span:6,placeholder:" ",disabled:!0,display:"2"===e.hide||"6"===e.hide},{label:"送货单号",prop:"deliNo",span:6,placeholder:" ",display:"2"===e.hide||"6"===e.hide,disabled:!0},{label:"纱线登记编号",prop:"registerNo",span:6,placeholder:" ",display:"1"===e.hide,disabled:!0},{label:"客戶名称",prop:"custName",span:6,cell:!1,display:"1"===e.hide,width:100,disabled:!0,type:"select",dicData:Object(h.b)("basCustomer","custName","custCode")},{label:"外发厂",prop:"factoryId",span:6,placeholder:" ",display:"5"===e.hide,disabled:!0}]}}function l(e){return{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,height:"calc(100vh - 247px)",refreshBtn:!1,columnBtn:!1,page:!0,roykey:"whseYarninDtloid",showSummary:!0,sumColumnList:[{label:" ",name:"cartonNum",type:"sum"},{label:" ",name:"weight",type:"sum"},{label:" ",name:"whseNum",type:"sum"},{label:" ",name:"cartonWei",type:"sum"}],column:[{prop:"index",label:"序号",width:60,align:"center"},{label:"纱线入仓明细OID",prop:"whseYarninDtloid",hide:!0},{label:"生產單號",prop:"poNo",cell:!0,hide:"4"!=e.hide,width:150,placeholder:"請選擇生產單號",type:"select",dicData:Object(h.b)("whseRetratyarnnotice","poNo","yarnsId"),click:function(t){e.choiceV=!e.choiceV,e.choiceField="poNo",e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.choiceTle="退紗通知單",e.iptChange(e.chooseData)},change:function(t){e.iptChange(e.chooseData)}},{label:"紗線系統編號",prop:"yarnsId",cell:"4"!=e.hide,width:120,placeholder:"請選擇紗線系統編號",click:function(t){e.choiceV=!e.choiceV,e.choiceField="yarnsId",e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.choiceTle="紗線系統編號",e.iptChange(e.chooseData)},change:function(t){e.iptChange(e.chooseData)}},{label:"紗線描述",prop:"yarnsName",cell:!1,width:350,type:"select",dicData:Object(h.b)("basYarnsData","yarnsName","yarnsId"),change:function(t){e.iptChange(e.chooseData)}},{label:"纱批/批号",prop:"batchNo",cell:!0,width:150,click:function(t){e.iptChange(e.chooseData)}},{label:"箱数",prop:"cartonNum",cell:!0,width:120,align:"right",click:function(t){e.iptChange(e.chooseData)},hide:"4"===e.hide},{label:"每箱锭数",prop:"everySpindle",cell:!0,width:120,align:"right",hide:"4"===e.hide,click:function(t){e.iptChange(e.chooseData)}},{label:"尾箱锭数",prop:"tailSpindle",cell:!0,width:120,hide:"4"===e.hide,align:"right",click:function(t){e.iptChange(e.chooseData)}},{label:"重量",prop:"weight",cell:!0,width:120,align:"right",click:function(t){e.iptChange(e.chooseData)}},{label:"重量单位",prop:"weightUnit",cell:!0,width:100,type:"select",dicData:Object(h.a)("Whse_Transfer_unit"),click:function(t){e.iptChange(e.chooseData)}},{label:"纱牌",prop:"yarnsCard",cell:!0,hide:"4"===e.hide,width:180,click:function(t){e.iptChange(e.chooseData)}},{label:"产地",prop:"placeOrigin",cell:!0,width:150,hide:"4"===e.hide,type:"select",dicData:Object(h.a)("Whse_Origin"),click:function(t){e.iptChange(e.chooseData)}},{label:"入仓数量",prop:"whseNum",cell:!0,hide:"4"===e.hide,width:120,align:"right",click:function(t){e.iptChange(e.chooseData)}},{label:"送货单重量",prop:"cartonWei",cell:!0,width:120,hide:"4"===e.hide,align:"right",click:function(t){e.iptChange(e.chooseData)}},{label:"纱线入仓_FK",prop:"whseYarninFk",hide:!0}]}}var r=i("g/wl"),d=i("Tjk1"),p={props:{datas:Object,detail:Object,everyThing:Object,hide:String},name:"",components:{choice:d.a},data:function(){return{loading:!1,page:{pageSize:10,currentPage:1,total:0},formOp:s(this),mxOp:l(this),mx:[{index:1}],other:[],form:{},oldData:{},chooseData:{},changeList:[],ruleV:!1,choiceV:!1,choiceTle:"來紗登記",choiceTarget:{},choiceField:"",choiceQ:{}}},watch:{},methods:{getDetail:function(){var e=this;0!==c()(this.detail).length&&this.detail.whseYarninoid?(this.loading=!0,this.changeList=[],this.mx=[],this.mxOp.showSummary=!1,Object(r.K)({rows:this.page.pageSize,start:this.page.currentPage,whseYarninFk:this.detail.whseYarninoid}).then(function(t){var i=t.data;e.page.total=i.total,e.mx=i.records,e.$refs.dlgcrud.setCurrentRow(),0===e.mx.length&&(e.loading=!1),e.mx.forEach(function(t,i){t.yarnsName=t.yarnsId,t.index=i+1,t.poNo=t.yarnsId,i===e.mx.length-1&&(e.mxOp.showSummary=!0,e.loading=!1)}),e.loading=!1})):this.mx=[]},add:function(){this.mx.length>0&&!this.mx[this.mx.length-1].whseYarninDtloid||(c()(this.oldData).length>0&&(this.oldData.$cellEdit=!1),this.mx.push({index:this.mx.length+1,$cellEdit:!0,custId:this.detail.custName,whseYarninFk:this.detail.whseYarninoid}),this.$refs.dlgcrud.setCurrentRow(this.mx[this.mx.length-1]),this.iptChange(this.mx[this.mx.length-1]),this.oldData=this.mx[this.mx.length-1])},iptChange:function(e){if(0===this.changeList.length)this.changeList.push(e);else for(var t=0;t<this.changeList.length;t++){if(e.index===this.changeList[t].index)return void(this.changeList[t]=e);this.changeList.length-1===t&&this.changeList[t].index!=e.index&&this.changeList.push(e)}},del:function(){var e=this;if(0!==c()(this.chooseData).length){if(!this.chooseData.whseYarninDtloid){this.mx.splice(this.chooseData.index-1,1);for(var t=0;t<this.changeList.length;t++)if(this.changeList[t].index===this.chooseData.index)return this.changeList.splice(t,1),void this.$refs.dlgcrud.setCurrentRow(this.mx[this.mx.length-1])}this.$tip.cofirm("是否确定删除",this,{}).then(function(){Object(r.x)(e.chooseData.whseYarninDtloid).then(function(t){200===t.data.code?(e.$tip.success("删除成功"),e.mx.splice(e.chooseData.index-1,1),e.oldData={},e.chooseData={}):e.$tip.error("删除失败")}).catch(function(t){e.$tip.error("删除失败!")})}).catch(function(t){e.$tip.warning("取消操作")})}else this.$tip.error("请选择要删除的数据!")},cellClick:function(e){this.oldData.$cellEdit=!1,this.$set(e,"$cellEdit",!0),this.oldData=e,this.chooseData=e},save:function(){for(var e=this,t=0;t<this.changeList.length;t++)if(!this.changeList[t].yarnsId||!this.changeList[t].batchNo)return void this.$tip.error("纱线系统编号/批号不能为空!");this.changeList.forEach(function(t,i){t.custId=e.detail.custName,t.whseYarninDtloid?Object(r.W)(t).then(function(e){}):Object(r.l)(t).then(function(e){})}),this.getDetail(),this.$tip.success("保存成功!")},close:function(){document.getElementsByClassName("el-dialog__headerbtn")[2].click()},choiceData:function(e){if(0!==c()(e).length){for(var t in this.oldData.$cellEdit=!1,"退紗通知單"===this.choiceTle&&(this.choiceTarget.yarnsId=e.yarnsId),this.choiceTarget.yarnsName=e.yarnsId,this.choiceTarget[this.choiceField]=e[this.choiceField],this.oldData.$cellEdit=!0,e)delete e[t];for(var t in this.choiceQ)delete this.choiceQ[t];this.choiceV=!1}else this.choiceV=!1}},created:function(){},mounted:function(){this.form=this.detail,this.getDetail()},beforeDestroy:function(){}},u={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"rcDetail"}},[i("view-container",{attrs:{title:e.datas.type.split("_")[0]+"入库"}},[i("div",{staticClass:"btnList"},[i("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("新增")]),e._v(" "),i("el-button",{attrs:{type:"danger"},on:{click:e.del}},[e._v("删除")]),e._v(" "),i("el-button",{attrs:{type:"success",disabled:0===e.changeList.length},on:{click:e.save}},[e._v("保存")]),e._v(" "),i("el-button",{attrs:{type:"warning"},on:{click:e.close}},[e._v("关闭")])],1),e._v(" "),i("div",{staticClass:"formBox"},[i("avue-form",{ref:"form",attrs:{option:e.formOp},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1),e._v(" "),i("el-row",{staticClass:"crudBox"},[i("el-col",{attrs:{span:Number(e.everyThing.dlgPp.split(":")[0])}},[i("view-container",{attrs:{title:e.datas.type.split("_")[0]+"入库明细"}},[i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dlgcrud",attrs:{option:e.mxOp,data:e.mx,page:e.page},on:{"update:page":function(t){e.page=t},"current-row-change":e.cellClick,"on-load":e.getDetail}})],1)],1)],1),e._v(" "),e.choiceV?i("choice",{attrs:{choiceV:e.choiceV,choiceTle:e.choiceTle,choiceQ:e.choiceQ,dlgWidth:"60%"},on:{choiceData:e.choiceData,close:function(t){e.choiceV=!1}}}):e._e()],1)],1)},staticRenderFns:[]};var g=i("VU/8")(p,u,!1,function(e){i("yEVX")},null,null).exports,f=i("sLX/"),m=i("gyMJ"),y={props:{datas:Object,detail:Object,everyThing:Object,hide:String},name:"",components:{choice:d.a},data:function(){return{loading:!1,page:{pageSize:10,currentPage:1,total:0},formOp:s(this),mxOp:l(this),mx:[{index:1}],other:[],form:{},oldData:{},chooseData:{},changeList:[],ruleV:!1,choiceV:!1,choiceTle:"來紗登記",choiceTarget:{},choiceField:"",choiceQ:{}}},watch:{},methods:{getDetail:function(){var e=this;0!==c()(this.detail).length&&this.detail.whseYarninoid?(this.loading=!0,this.oldData={},this.changeList=[],this.chooseData={},Object(r.K)({rows:this.page.pageSize,start:this.page.currentPage,whseYarninFk:this.detail.whseYarninoid}).then(function(t){var i=t.data;e.page.total=i.total,e.mx=i.records,e.$refs.dlgcrud.setCurrentRow(),0===e.mx.length&&(e.loading=!1),e.mx.forEach(function(t,i){t.yarnsName=t.yarnsId,t.index=i+1,i===e.mx.length-1&&(e.loading=!1)})})):this.mx=[]},add:function(){this.mx.length>0&&!this.mx[this.mx.length-1].whseYarninDtloid||(c()(this.oldData).length>0&&(this.oldData.$cellEdit=!1),this.mx.push({index:this.mx.length+1,$cellEdit:!0,whseYarninFk:this.detail.whseYarninoid}),this.$refs.dlgcrud.setCurrentRow(this.mx[this.mx.length-1]),this.iptChange(this.mx[this.mx.length-1]),this.oldData=this.mx[this.mx.length-1])},iptChange:function(e){if(0===this.changeList.length)this.changeList.push(e);else for(var t=0;t<this.changeList.length;t++){if(e.index===this.changeList[t].index)return void(this.changeList[t]=e);this.changeList.length-1===t&&this.changeList[t].index!=e.index&&this.changeList.push(e)}},del:function(){var e=this;if(0!==c()(this.chooseData).length){if(!this.chooseData.whseYarninDtloid){this.mx.splice(this.chooseData.index-1,1);for(var t=0;t<this.changeList.length;t++)if(this.changeList[t].index===this.chooseData.index)return this.changeList.splice(t,1),void this.$refs.dlgcrud.setCurrentRow(this.mx[this.mx.length-1])}this.$tip.cofirm("是否确定删除",this,{}).then(function(){Object(r.x)(e.chooseData.whseYarninDtloid).then(function(t){200===t.data.code?(e.$tip.success("删除成功"),e.mx.splice(e.chooseData.index-1,1),e.getDetail()):e.$tip.error("删除失败")}).catch(function(t){e.$tip.error("删除失败!")})}).catch(function(t){e.$tip.warning("取消操作")})}else this.$tip.error("请选择要删除的数据!")},cellClick:function(e){this.oldData.$cellEdit=!1,this.$set(e,"$cellEdit",!0),this.oldData=e,this.chooseData=e},save:function(){for(var e=0;e<this.changeList.length;e++)if(!this.changeList[e].yarnsId||!this.changeList[e].batchNo)return void this.$tip.error("纱线系统编号/批号不能为空!");this.changeList.forEach(function(e,t){e.whseYarninDtloid?Object(r.W)(e).then(function(e){}):Object(r.l)(e).then(function(e){})}),this.getDetail(),this.$tip.success("保存成功!")},close:function(){document.getElementsByClassName("el-dialog__headerbtn")[2].click()},choiceData:function(e){if(0!==c()(e).length){for(var t in this.oldData.$cellEdit=!1,this.choiceTarget.yarnsName=e.yarnsId,this.choiceTarget[this.choiceField]=e[this.choiceField],this.oldData.$cellEdit=!0,e)delete e[t];for(var t in this.choiceQ)delete this.choiceQ[t];this.choiceV=!1}else this.choiceV=!1}},created:function(){},mounted:function(){this.form=this.detail,this.getDetail()},beforeDestroy:function(){}},D={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"rcDetail"}},[i("view-container",{attrs:{title:e.datas.type.split("_")[0]+"入库"}},[i("div",{staticClass:"btnList"},[i("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("新增")]),e._v(" "),i("el-button",{attrs:{type:"danger"},on:{click:e.del}},[e._v("删除")]),e._v(" "),i("el-button",{attrs:{type:"success",disabled:0===e.changeList.length},on:{click:e.save}},[e._v("保存")]),e._v(" "),i("el-button",{attrs:{type:"warning"},on:{click:e.getDetail}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"warning"},on:{click:e.close}},[e._v("关闭")])],1),e._v(" "),i("div",{staticClass:"formBox"},[i("avue-form",{ref:"form",attrs:{option:e.formOp},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1),e._v(" "),i("el-row",{staticClass:"crudBox"},[i("el-col",{attrs:{span:Number(e.everyThing.dlgPp.split(":")[0])}},[i("view-container",{attrs:{title:e.datas.type.split("_")[0]+"通知單"}},[i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dlgcrud",attrs:{option:e.mxOp,data:e.mx,page:e.page},on:{"update:page":function(t){e.page=t},"current-row-change":e.cellClick,"on-load":e.getDetail}})],1)],1)],1),e._v(" "),e.choiceV?i("choice",{attrs:{choiceV:e.choiceV,choiceTle:e.choiceTle,choiceQ:e.choiceQ,dlgWidth:"60%"},on:{choiceData:e.choiceData,close:function(t){e.choiceV=!1}}}):e._e()],1)],1)},staticRenderFns:[]};i("VU/8")(y,D,!1,function(e){i("QNHF")},null,null).exports;var b={name:"",components:{temDlg:g,ruleDlg:f.a,choice:d.a},data:function(){return{dialogVisible:!1,loading:!1,data:JSON.parse(localStorage.getItem("imWk")),page:{pageSize:10,currentPage:1,total:0},hide:JSON.parse(localStorage.getItem("imWk")).type.split("_")[1],formOp:{},form:{},crudOp:{},crud:[],detail:{},everyThing:{},oldData:{},chooseData:{},changeList:[],ruleV:!1,choiceV:!1,choiceTle:"來紗登記",choiceTarget:{},choiceField:"",choiceQ:{}}},watch:{},methods:{getData:function(){var e,t=this;for(var i in this.loading=!0,this.oldData={},this.changeList=[],this.everyThing={mainF:(e=this,{submitBtn:!1,emptyBtn:!1,labelWidth:130,column:[{label:"入仓编号",prop:"yinId",span:6,placeholder:" "},{label:"入仓日期",prop:"yinDate",span:6,placeholder:" ",type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss"},{label:"採購單號",prop:"purNo",span:6,placeholder:" ",display:"2"===e.hide||"6"===e.hide},{label:"纱线登记编号",prop:"registerNo",span:6,placeholder:" ",display:"1"===e.hide},{label:"送货单号",prop:"deliNo",span:6,placeholder:" ",display:"2"===e.hide||"6"===e.hide},{label:"检验状态",prop:"yinStatus",span:6,placeholder:" ",type:"select",dicData:Object(h.a)("whse_yinstatus")},{label:"财务状态",prop:"finStatus",span:6,placeholder:" ",type:"select",display:"4"!=e.hide&&"5"!=e.hide,dicData:Object(h.a)("whse_finStatus")}]}),mainC:function(e){return{menu:!1,addBtn:!1,border:!0,highlightCurrentRow:!0,height:"4"===e.hide||"5"===e.hide?"calc(100vh - 250px)":"calc(100vh - 295px)",refreshBtn:!1,columnBtn:!1,page:!0,column:[{label:"纱线入仓OID",prop:"whseYarninoid",hide:!0},{label:"序号",prop:"index",width:60,align:"center"},{label:"创建日期",prop:"sysCreated",hide:!0,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(t){e.iptChange(e.chooseData)},change:function(t){""===t.value&&e.iptChange(e.chooseData)}},{label:"记录删除标记",prop:"sysDeleted",hide:!0},{label:"入仓编号",prop:"yinId",cell:!0,width:200,change:function(t){""===t.value&&e.iptChange(e.chooseData)}},{label:"入仓类型",prop:"yinType",cell:!1,width:120,type:"select",dicData:Object(h.a)("Whse_yinType"),change:function(t){e.iptChange(e.chooseData)}},{label:"入仓日期",prop:"yinDate",cell:!0,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(t){e.iptChange(e.chooseData)},change:function(t){""===t.value&&e.iptChange(e.chooseData)},width:200,align:"center"},{label:"採購單號",prop:"purNo",cell:!0,hide:"2"!==e.hide&&"6"!==e.hide,width:220,change:function(t){""===t.value&&e.iptChange(e.chooseData)},placeholder:"請選擇採購單號",click:function(){e.choiceV=!e.choiceV,e.choiceField="purNo",e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.choiceTle="採購單"}},{label:"送貨單号",prop:"deliNo",cell:!0,width:180,type:"select",hide:"2"!==e.hide&&"6"!==e.hide,click:function(t){e.chooseData.purNo?(e.choiceV=!e.choiceV,e.choiceQ.deliType="yarns",e.choiceField="deliNo",e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.choiceTle="送貨單"):e.$tip.error("請先選擇採購單號！")},change:function(t){""===t.value&&e.iptChange(e.chooseData)},placeholder:"請選擇送貨單號"},{label:"纱线登记编号",prop:"registerNo",cell:!0,width:180,type:"select",placeholder:"請選擇纱线登记编号",hide:"1"!==e.hide,click:function(){e.choiceField="registerNo",e.choiceV=!e.choiceV,e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.choiceTle="來紗登記"},change:function(t){""===t.value&&e.iptChange(e.chooseData)}},{label:"客戶編號",prop:"custId",cell:!1,hide:"1"!==e.hide,width:150,type:"select",dicData:Object(h.b)("salIncomingyarn","custCode","registerNo")},{label:"客戶名称",prop:"custName",cell:!1,hide:"1"!==e.hide,type:"select",dicData:Object(h.b)("basCustomer","custName","custCode"),width:150},{label:"检验状态",prop:"yinStatus",cell:!0,width:120,type:"select",dicData:Object(h.a)("whse_yinstatus"),change:function(t){e.iptChange(e.chooseData)}},{label:"外工厂代號",prop:"factoryId",cell:!0,hide:"5"!==e.hide,width:150,placeholder:"请选择加工厂代號",click:function(){e.choiceField="factoryId",e.choiceV=!e.choiceV,e.oldData=e.chooseData,e.choiceTarget=e.oldData,e.choiceTle="外厂纱线配料计划",e.iptChange(e.chooseData)}},{label:"外工厂名稱",prop:"factoryName",cell:!1,hide:"5"!==e.hide,width:150,type:"select",dicData:Object(h.b)("vWhseRetyarninoutPlan","refName","refCode")},{label:"指令单",prop:"instructId",hide:!0},{label:"财务状态",prop:"finStatus",cell:!0,width:120,hide:"5"==e.hide||"4"==e.hide,type:"select",dicData:Object(h.a)("whse_finStatus"),click:function(t){e.iptChange(e.chooseData)}},{label:"创建用户",prop:"sysCreatedby",hide:!0},{label:"授权用户",prop:"sysReplacement",hide:!0},{label:"所属岗位",prop:"sysPostn",hide:!0},{label:"所属部门",prop:"sysDivision",hide:!0},{label:"所属组织",prop:"sysOrg",hide:!0},{label:"最后修改用户",prop:"sysLastUpdBy",hide:!0,width:150},{label:"最后修改日期",prop:"sysLastUpd",hide:!0,type:"datetime",width:180,format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",focus:function(t){e.iptChange(e.chooseData)},change:function(t){""===t.value&&e.iptChange(e.chooseData)},align:"center"}]}}(this),dlgF1:s,dlgC1:l,dlgC2:{},dlgPp:"24:0",fc:r.J},this.form)""===this.form[i]&&delete this.form[i];Object(r.J)(o()(this.form,{rows:this.page.pageSize,start:this.page.currentPage,yinType:JSON.parse(localStorage.getItem("imWk")).type.split("_")[1]})).then(function(e){var i=e.data;t.page.total=i.total,t.crud=i.records,t.crud.forEach(function(e,i){z,e.finStatus=String(e.finStatus),e.index=i+1,e.factoryName=e.factoryId,e.custId=e.registerNo;var a=t;a.$nextTick(function(){document.getElementsByClassName("el-table__row")[i].addEventListener("input",function(){a.iptChange(e)},!1),t.$set(e,"custName",e.$custId),i===t.crud.length-1&&(a.loading=!1)})}),0===t.crud.length&&(t.loading=!1)}).catch(function(e){t.loading=!1})},add:function(){var e=this;if(!(this.crud.length>0)||this.crud[this.crud.length-1].whseYarninoid){c()(this.oldData).length>0&&(this.oldData.$cellEdit=!1);var t={index:this.crud.length+1,$cellEdit:!0,yinType:this.hide,yinId:"",yinDate:this.$getNowTime(),finStatus:"0"};Object(m.a)({code:"whse_In_yarn"}).then(function(e){t.yinId=e.data.data}),this.crud.push(t),this.$refs.crud.setCurrentRow(this.crud[this.crud.length-1]),this.iptChange(this.crud[this.crud.length-1]),this.oldData=this.crud[this.crud.length-1],this.$nextTick(function(){var t=e;document.getElementsByClassName("el-table__row")[t.crud.length-1].addEventListener("input",function(){t.iptChange(t.oldData)},!1)})}},iptChange:function(e){if(0===this.changeList.length)this.changeList.push(e);else for(var t=0;t<this.changeList.length;t++){if(e.index===this.changeList[t].index)return void(this.changeList[t]=e);this.changeList.length-1===t&&this.changeList[t].index!=e.index&&this.changeList.push(e)}},del:function(){var e=this;if(0!==c()(this.chooseData).length){if(!this.chooseData.whseYarninoid){this.crud.splice(this.chooseData.index-1,1);for(var t=0;t<this.changeList.length;t++)if(this.changeList[t].index===this.chooseData.index)return this.changeList.splice(t,1),void this.$refs.crud.setCurrentRow(this.crud[this.crud.length-1])}this.$tip.cofirm("是否确定删除",this,{}).then(function(){Object(r.w)(e.chooseData.whseYarninoid).then(function(t){200===t.data.code?(e.$tip.success("删除成功"),e.crud.splice(e.chooseData.index-1,1),e.getData()):e.$tip.error("删除失败")}).catch(function(t){e.$tip.error("删除失败!")})}).catch(function(t){e.$tip.warning("取消操作")})}else this.$tip.error("请选择要删除的数据!")},cellClick:function(e){this.oldData.$cellEdit=!1,this.$set(e,"$cellEdit",!0),this.oldData=e,this.chooseData=e},save:function(){for(var e=0;e<this.changeList.length;e++){if(!this.changeList[e].yinId||!this.changeList[e].registerNo&&"1"===this.hide)return void this.$tip.error("入仓编号/紗線編號不能为空!");if(!this.changeList[e].yinId||!this.changeList[e].purNo&&"2"===this.hide)return void this.$tip.error("入仓编号/採購單號不能为空!")}this.changeList.forEach(function(e,t){"null"===e.finStatus&&(e.finStatus=""),e.whseYarninoid?Object(r.V)(e).then(function(e){}):Object(r.k)(e).then(function(e){})}),this.getData(),this.$tip.success("保存成功!")},close:function(){document.getElementsByClassName("el-dialog__headerbtn")[0].click()},handleRowDBLClick:function(e){e.whseYarninoid?(this.detail=e,this.choiceV=!1,this.dialogVisible=!0):this.$tip.error("請先保存主表數據!")},choiceData:function(e){if(0!==c()(e).length){for(var t in this.oldData.$cellEdit=!1,this.choiceTarget[this.choiceField]=e[this.choiceField],"外厂纱线配料计划"===this.choiceTle&&(this.choiceTarget.factoryId=e.refCode,this.choiceTarget.factoryName=e.refCode),this.oldData.$cellEdit=!0,e)delete e[t];for(var t in this.choiceQ)delete this.choiceQ[t];this.choiceV=!1}else this.choiceV=!1}},created:function(){},mounted:function(){},beforeDestroy:function(){}},v={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"rc"}},[i("view-container",{attrs:{title:e.data.type.split("_")[0]}},[i("div",{staticClass:"btnList"},[i("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("新增")]),e._v(" "),i("el-button",{attrs:{type:"success",disabled:0===e.changeList.length},on:{click:e.save}},[e._v("保存")]),i("el-button",{attrs:{type:"danger"},on:{click:e.del}},[e._v("删除")]),e._v(" "),i("el-button",{attrs:{type:"warning"},on:{click:function(t){e.ruleV=!0}}},[e._v("編號規則配置")]),e._v(" "),i("el-button",{attrs:{type:"warning"},on:{click:e.close}},[e._v("关闭")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.getData}},[e._v("查询")])],1),e._v(" "),i("div",{staticClass:"formBox"},[i("avue-form",{ref:"form",attrs:{option:e.everyThing.mainF},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1),e._v(" "),i("el-row",{staticClass:"crudBox"},[i("el-col",{attrs:{span:24}},[i("view-container",{attrs:{title:e.data.type.split("_")[0]+"入库"}},[i("avue-crud",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"crud",attrs:{option:e.everyThing.mainC,data:e.crud,page:e.page},on:{"update:page":function(t){e.page=t},"on-load":e.getData,"row-dblclick":e.handleRowDBLClick,"current-row-change":e.cellClick}})],1)],1)],1),e._v(" "),e.dialogVisible?i("el-dialog",{attrs:{id:"sxrcDlg",visible:e.dialogVisible,width:"100%","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("tem-dlg",{ref:"tem",attrs:{datas:e.data,detail:e.detail,everyThing:e.everyThing,hide:e.hide}})],1):e._e(),e._v(" "),e.ruleV?i("el-dialog",{attrs:{id:"wkRuleDlg",visible:e.ruleV,width:"50%","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.ruleV=t}}},[i("rule-dlg",{ref:"rule",attrs:{rcType:"whse_In_yarn"},on:{close:function(t){e.ruleV=!1}}})],1):e._e(),e._v(" "),e.choiceV?i("choice",{attrs:{choiceV:e.choiceV,choiceTle:e.choiceTle,choiceQ:e.choiceQ,dlgWidth:"60%"},on:{choiceData:e.choiceData,close:function(t){e.choiceV=!1}}}):e._e()],1)],1)},staticRenderFns:[]};var w=i("VU/8")(b,v,!1,function(e){i("HdFe")},null,null);t.default=w.exports},yEVX:function(e,t){}});
//# sourceMappingURL=9.afc40ed146c66fbe36f4.js.map